(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{3955:(e,r,a)=>{"use strict";a.d(r,{default:()=>_});var t=a(95155),s=a(66766),n=a(12115),i=a(40283),o=a(35695),l=a(6874),c=a.n(l),d=a(51362);let u={count:3};var h=a(78046),g=a(58828),m=a(81131),x=a(37124),y=a(6678),f=a(37186),b=a(50008),p=a(55596),v=a(60815);function j(e){let{user:r,logout:a}=e,[i,o]=(0,n.useState)(""),[l,c]=(0,n.useState)(!1),{theme:j,setTheme:k}=(0,d.D)(),w=function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,n.useEffect)(()=>{if(!r)return;let a=r=>{ref.current&&!ref.current.contains(r.target)&&e()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[e,r]),ref}(()=>c(!1),l);return(0,t.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50",children:(0,t.jsx)("div",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsx)("div",{className:"flex-1 max-w-lg mx-6",children:(0,t.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i.trim()},className:"relative",children:[(0,t.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar leads, empresas...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]})}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 flex-1 justify-end",children:[(0,t.jsxs)("button",{className:"relative p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)(g.A,{className:"w-5 h-5"}),u.count>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:u.count})]}),(0,t.jsx)("button",{onClick:()=>{k("dark"===j?"light":"dark")},className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"dark"===j?"Cambiar a modo claro":"Cambiar a modo oscuro",children:"dark"===j?(0,t.jsx)(m.A,{className:"w-5 h-5"}):(0,t.jsx)(x.A,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"relative",ref:w,children:[(0,t.jsxs)("button",{onClick:()=>c(!l),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)(s.default,{src:r.image||"/default-avatar.png",alt:r.name||"User",className:"w-8 h-8 rounded-full border-2 border-gray-200 dark:border-gray-600"}),(0,t.jsxs)("div",{className:"text-left hidden sm:block",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.email})]}),(0,t.jsx)(v.A,{className:"w-4 h-4 text-gray-400 transition-transform ".concat(l?"rotate-180":"")})]}),l&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.email})]}),(0,t.jsxs)("button",{className:"w-full flex items-center px-4 py-3 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)(y.A,{className:"w-4 h-4 mr-3"}),"Ver Perfil"]}),(0,t.jsxs)("button",{className:"w-full flex items-center px-4 py-3 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)(f.A,{className:"w-4 h-4 mr-3"}),"Configuraci\xf3n"]}),(0,t.jsxs)("button",{className:"w-full flex items-center px-4 py-3 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)(b.A,{className:"w-4 h-4 mr-3"}),"Ayuda"]}),(0,t.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("button",{onClick:a,className:"w-full flex items-center px-4 py-3 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[(0,t.jsx)(p.A,{className:"w-4 h-4 mr-3"}),"Cerrar Sesi\xf3n"]})})]})]})]})]})})})}var k=a(39968),w=a(36545),N=a(55628),A=a(5279);class C extends n.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.warn("ErrorBoundary caught an error:",e,r),this.props.onError&&this.props.onError(e,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:(0,t.jsxs)(w.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-8 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:(0,t.jsx)(N.A,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"\xa1Oops! Algo sali\xf3 mal"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. Nuestro equipo ha sido notificado."}),!1,(0,t.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,t.jsxs)("button",{onClick:this.handleRetry,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,t.jsx)(A.A,{className:"w-4 h-4"}),"Reintentar"]}),(0,t.jsx)("button",{onClick:this.handleReload,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg text-sm font-medium transition-colors",children:"Recargar p\xe1gina"})]})]})}):this.props.children}constructor(...e){super(...e),this.state={hasError:!1},this.handleReload=()=>{window.location.reload()},this.handleRetry=()=>{this.setState({hasError:!1,error:void 0})}}}var E=a(69994),S=a(12513),P=a(18276),O=a(5500),R=a(86474),T=a(19145),J=a(57340),F=a(17580),I=a(72713),L=a(49376),q=a(34869),z=a(381);let D=[{name:"Dashboard",href:"/",icon:E.A,description:"Resumen de actividad de enriquecimiento"},{name:"Leads",href:"/leads",icon:S.A,description:"Gesti\xf3n de leads y prospects"},{name:"Task Management",href:"/tasks",icon:T.A,description:"Gesti\xf3n de tareas con IA y validaci\xf3n"},{name:"HubSpot",href:"/hubspot",icon:P.A,description:"Integraci\xf3n y sincronizaci\xf3n de HubSpot"},{name:"Analytics",href:"/analytics",icon:O.A,description:"An\xe1lisis detallado del rendimiento"},{name:"AI Assistant",href:"/ai",icon:R.A,description:"Asistente IA, generaci\xf3n de contenido y an\xe1lisis inteligente"},{name:"Configuraci\xf3n",href:"/settings",icon:f.A,description:"Configuraci\xf3n de la aplicaci\xf3n",children:[{name:"General",href:"/settings",icon:f.A},{name:"Seguridad",href:"/settings/security",icon:f.A}]}];function _(e){let{children:r}=e,{user:a,isLoading:l,logout:d}=(0,i.As)(),u=(0,o.usePathname)(),h=(0,o.useRouter)();return((0,n.useEffect)(()=>{l||a||(null==u?void 0:u.startsWith("/auth"))||h.push("/auth/signin")},[a,l,u,h]),l)?(0,t.jsx)(k.Ay,{variant:"page",message:"Iniciando Prospecter...",size:"lg"}):(null==u?void 0:u.startsWith("/auth"))?(0,t.jsx)("div",{className:"min-h-screen",children:r}):a?(0,t.jsxs)("div",{className:"h-screen flex bg-gray-50 dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"w-64 bg-white dark:bg-gray-800 shadow-sm border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Prospecter"})}),(0,t.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:D.map(e=>{let r=u===e.href;return(0,t.jsxs)(c(),{href:e.href,className:"flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat(r?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"),children:[(0,t.jsx)(e.icon,{className:"mr-3 h-5 w-5 ".concat(r?"text-blue-500":"")}),e.name]},e.name)})}),(0,t.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center mb-3",children:[(0,t.jsx)(s.default,{src:a.image||"/default-avatar.png",alt:a.name||"User",className:"w-8 h-8 rounded-full mr-3"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:a.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:a.email})]})]}),(0,t.jsxs)("button",{onClick:d,className:"flex items-center w-full px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white rounded-lg transition-colors",children:[(0,t.jsx)(p.A,{className:"mr-3 h-5 w-5"}),"Cerrar Sesi\xf3n"]})]})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,t.jsx)(j,{user:a,logout:d,currentPath:u||"/"}),(0,t.jsx)("main",{className:"flex-1 overflow-auto p-6",children:(0,t.jsx)(C,{children:r})})]})]}):(0,t.jsx)(k.Ay,{variant:"page",message:"Redirigiendo al login...",size:"lg"})}f.A,J.A,F.A,T.A,I.A,L.A,q.A,z.A},30347:()=>{},40283:(e,r,a)=>{"use strict";a.d(r,{As:()=>c,OJ:()=>l});var t=a(95155),s=a(12115),n=a(45493);let i=(0,s.createContext)(void 0);function o(e){let{children:r}=e,{data:a,status:o}=(0,n.wV)(),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),h=(null==a?void 0:a.user)?{id:a.user.id,name:a.user.name,email:a.user.email,image:a.user.image||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(a.user.name||a.user.email||""),"&background=3b82f6&color=ffffff"),role:a.user.role||"user",lastLogin:a.user.lastLogin?new Date(a.user.lastLogin):void 0}:null,g="loading"===o,m=async(e,r)=>{try{let a=await fetch("/api/auth/check-2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),t=!1;a.ok&&(t=(await a.json()).has2FA);let s=await (0,n.Jv)("credentials",{email:e,password:r,redirect:!1});if(null==s?void 0:s.error){if(t&&"CredentialsSignin"===s.error)return c(!0),u(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!1,error:"CredentialsSignin"===s.error?"Credenciales inv\xe1lidas":s.error}}if(t)return c(!0),u(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!0}}catch(e){return{success:!1,error:"Error al iniciar sesi\xf3n"}}},x=async(e,r)=>{try{let a=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,token:r})});if(!a.ok){let e=await a.json();return{success:!1,error:e.message||"C\xf3digo 2FA inv\xe1lido"}}let t=await (0,n.Jv)("credentials",{email:e,token:r,redirect:!1});if(null==t?void 0:t.error)return{success:!1,error:"Error completando autenticaci\xf3n"};return c(!1),u(null),{success:!0}}catch(e){return{success:!1,error:"Error verificando 2FA"}}},y=async(e,r,a)=>{try{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:r,password:a})});if(!t.ok){let e=await t.json();return{success:!1,error:e.message||"Error al crear la cuenta"}}return await m(r,a)}catch(e){return{success:!1,error:"Error al crear la cuenta"}}},f=async e=>{try{let r=await (0,n.Jv)(e,{redirect:!1});if(null==r?void 0:r.error)return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)};return{success:!0}}catch(r){return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)}}},b=async()=>{c(!1),u(null),await (0,n.CI)({redirect:!1})},p=async e=>{try{if(!(await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)return{success:!1,error:"Error al enviar email de recuperaci\xf3n"};return{success:!0}}catch(e){return{success:!1,error:"Error al procesar solicitud de recuperaci\xf3n"}}};return(0,t.jsx)(i.Provider,{value:{user:h,loading:g,isLoading:g,requires2FA:l,pending2FAEmail:d,login:m,verify2FA:x,register:y,logout:b,socialLogin:f,resetPassword:p,session:a},children:r})}function l(e){let{children:r}=e;return(0,t.jsx)(n.CP,{children:(0,t.jsx)(o,{children:r})})}function c(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},59242:(e,r,a)=>{Promise.resolve().then(a.bind(a,78260)),Promise.resolve().then(a.t.bind(a,30347,23)),Promise.resolve().then(a.bind(a,60881)),Promise.resolve().then(a.bind(a,3955))},60881:(e,r,a)=>{"use strict";a.d(r,{Providers:()=>c});var t=a(95155),s=a(12115),n=a(49887),i=a(51362),o=a(40283),l=a(39968);function c(e){let{children:r}=e,[a,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{c(!0)},[]),(0,t.jsx)(i.N,{attribute:"class",defaultTheme:"light",enableSystem:!1,themes:["light","dark"],children:(0,t.jsx)(n.M,{children:(0,t.jsx)(o.OJ,{children:(0,t.jsx)("div",{suppressHydrationWarning:!0,children:a?r:(0,t.jsx)(l.Ay,{variant:"page",message:"Iniciando aplicaci\xf3n...",size:"lg"})})})})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[690,545,71,493,874,907,274,815,242,968,441,684,358],()=>r(59242)),_N_E=e.O()}]);