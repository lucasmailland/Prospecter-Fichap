(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{12280:(e,a,r)=>{Promise.resolve().then(r.bind(r,33756))},33756:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>eu});var s=r(95155),t=r(12115),l=r(36545),i=r(40283),n=r(60760),o=r(73403),c=r(14464),d=r(84520),u=r(1493),m=r(11846),x=r(64820),h=r(43194),g=r(97376),p=r(83580),y=r(69953),b=r(18850),j=r(45998),f=r(46786),N=r(8620),v=r(58739),k=r(60441),w=r(3474),C=r(50766),A=r(78447),E=r(53773),L=r(95604),P=r(58451),S=r(64177),M=r(33183),I=r(21202),O=r(40058),T=r(29337),q=r(8246),R=r(10184),D=r(14170),U=r(5246),z=r(31151),_=r(57765),B=r(78046),K=r(55628),V=r(78260),F=r(39968);let G=[{value:"ALL",label:"Todos los roles"},{value:"ADMIN",label:"Administradores"},{value:"MANAGER",label:"Managers"},{value:"USER",label:"Usuarios"}],W=[{value:"ALL",label:"Todos los estados"},{value:"ACTIVE",label:"Activos"},{value:"LOCKED",label:"Bloqueados"}],J=[{value:10,label:"10 por p\xe1gina"},{value:25,label:"25 por p\xe1gina"},{value:50,label:"50 por p\xe1gina"},{value:100,label:"100 por p\xe1gina"}],Y=e=>{let a={length:e.length>=8,uppercase:/[A-Z]/.test(e),lowercase:/[a-z]/.test(e),number:/[0-9]/.test(e),special:/[!@#$%^&*(),.?":{}|<>]/.test(e)},r=Object.values(a).filter(Boolean).length,s=[];return a.length||s.push("M\xednimo 8 caracteres"),a.uppercase||s.push("Al menos una may\xfascula"),a.lowercase||s.push("Al menos una min\xfascula"),a.number||s.push("Al menos un n\xfamero"),a.special||s.push("Al menos un car\xe1cter especial"),{isValid:0===s.length,errors:s,strength:r/5*100,checks:a}},H=e=>{let{isOpen:a,onClose:r,onInvite:l,loading:i}=e,[n,y]=(0,t.useState)({firstName:"",lastName:"",email:"",role:"USER"}),b=()=>{y({firstName:"",lastName:"",email:"",role:"USER"})};return(0,t.useEffect)(()=>{a||b()},[a]),(0,s.jsx)(o.Y,{isOpen:a,onClose:r,size:"lg",children:(0,s.jsxs)(c.g,{children:[(0,s.jsxs)(d.c,{className:"flex flex-col gap-1",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold",children:"Invitar Usuario"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Agrega un nuevo miembro al equipo"})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l(n)},children:[(0,s.jsx)(u.h,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(m.r,{label:"Nombre",placeholder:"Juan",value:n.firstName,onChange:e=>y({...n,firstName:e.target.value}),required:!0,variant:"bordered"}),(0,s.jsx)(m.r,{label:"Apellido",placeholder:"P\xe9rez",value:n.lastName,onChange:e=>y({...n,lastName:e.target.value}),required:!0,variant:"bordered"}),(0,s.jsx)(m.r,{label:"Email",type:"email",placeholder:"juan@empresa.com",value:n.email,onChange:e=>y({...n,email:e.target.value}),required:!0,variant:"bordered",className:"md:col-span-2"}),(0,s.jsxs)(x.d,{label:"Rol",placeholder:"Selecciona un rol",selectedKeys:[n.role],onSelectionChange:e=>y({...n,role:Array.from(e)[0]}),variant:"bordered",className:"md:col-span-2",children:[(0,s.jsx)(h.y,{children:"Usuario"},"USER"),(0,s.jsx)(h.y,{children:"Manager"},"MANAGER"),(0,s.jsx)(h.y,{children:"Administrador"},"ADMIN")]})]})}),(0,s.jsxs)(g.q,{children:[(0,s.jsx)(p.T,{variant:"light",onPress:r,children:"Cancelar"}),(0,s.jsx)(p.T,{color:"primary",type:"submit",isLoading:i,startContent:!i&&(0,s.jsx)(O.A,{className:"w-4 h-4"}),children:i?"Invitando...":"Invitar Usuario"})]})]})]})})},X=e=>{let{isOpen:a,onClose:r,onUpdate:l,loading:i,user:n,currentUserRole:b,currentUser:j}=e,[f,N]=(0,t.useState)({firstName:"",lastName:"",email:"",role:"",accountLocked:!1,newPassword:"",confirmPassword:""}),[v,k]=(0,t.useState)(null),[w,C]=(0,t.useState)(""),[A,E]=(0,t.useState)(!1);(0,t.useEffect)(()=>{n&&N({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",role:n.role||"",accountLocked:n.accountLocked||!1,newPassword:"",confirmPassword:""})},[n]);let L=e=>{N({...f,newPassword:e}),e?k(Y(e)):k(null),f.confirmPassword&&e!==f.confirmPassword?C("Las contrase\xf1as no coinciden"):C("")},P=e=>{N({...f,confirmPassword:e}),e&&f.newPassword!==e?C("Las contrase\xf1as no coinciden"):C("")},S=()=>{n&&N({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",role:n.role||"",accountLocked:n.accountLocked||!1,newPassword:"",confirmPassword:""}),k(null),C("")};if((0,t.useEffect)(()=>{a||S()},[a]),!n)return null;let M="ADMIN"===b,I="MANAGER"===b;n.role;let O=(M||I)&&n.id!==(null==j?void 0:j.id),q=M||I||n.id===(null==j?void 0:j.id);return(0,s.jsx)(o.Y,{isOpen:a,onClose:r,size:"xl",children:(0,s.jsxs)(c.g,{children:[(0,s.jsxs)(d.c,{className:"flex flex-col gap-1",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold",children:"Editar Usuario"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Modifica la informaci\xf3n del usuario"})]}),(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),n){if(f.newPassword){if(!(null==v?void 0:v.isValid))return;if(f.newPassword!==f.confirmPassword)return void C("Las contrase\xf1as no coinciden")}let e={firstName:f.firstName,lastName:f.lastName,email:f.email,role:f.role,accountLocked:f.accountLocked};f.newPassword&&(e.newPassword=f.newPassword),l(n.id,e)}},children:[(0,s.jsxs)(u.h,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(m.r,{label:"Nombre",placeholder:"Juan",value:f.firstName,onChange:e=>N({...f,firstName:e.target.value}),required:!0,variant:"bordered",isDisabled:!q}),(0,s.jsx)(m.r,{label:"Apellido",placeholder:"P\xe9rez",value:f.lastName,onChange:e=>N({...f,lastName:e.target.value}),required:!0,variant:"bordered",isDisabled:!q}),(0,s.jsx)(m.r,{label:"Email",type:"email",value:f.email,onChange:e=>N({...f,email:e.target.value}),variant:"bordered",isDisabled:!q,className:"md:col-span-2"}),(0,s.jsxs)(x.d,{label:"Rol",placeholder:"Selecciona un rol",selectedKeys:[f.role],onSelectionChange:e=>N({...f,role:Array.from(e)[0]}),variant:"bordered",isDisabled:!M,description:M?"":"Solo administradores pueden cambiar roles",children:[(0,s.jsx)(h.y,{children:"Usuario"},"USER"),(0,s.jsx)(h.y,{children:"Manager"},"MANAGER"),M?(0,s.jsx)(h.y,{children:"Administrador"},"ADMIN"):null]}),O&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Estado de la cuenta"}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-full ".concat(f.accountLocked?"bg-red-100 dark:bg-red-900":"bg-green-100 dark:bg-green-900"),children:f.accountLocked?(0,s.jsx)("svg",{className:"w-4 h-4 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):(0,s.jsx)("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:f.accountLocked?"Cuenta bloqueada":"Cuenta activa"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:f.accountLocked?"El usuario no puede iniciar sesi\xf3n":"El usuario puede iniciar sesi\xf3n normalmente"})]})]}),(0,s.jsx)(y.Z,{isSelected:!f.accountLocked,onValueChange:e=>N({...f,accountLocked:!e}),size:"sm",color:f.accountLocked?"danger":"success",thumbIcon:e=>{let{isSelected:a,className:r}=e;return a?(0,s.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}})]}),!O&&(0,s.jsx)("p",{className:"text-xs text-gray-500 italic",children:"No puedes cambiar el estado de tu propia cuenta"})]})]}),(0,s.jsxs)("div",{className:"mt-6 border-t pt-6",children:[(0,s.jsxs)("h4",{className:"font-medium mb-4 flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Cambiar contrase\xf1a"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(m.r,{label:"Nueva contrase\xf1a",type:A?"text":"password",value:f.newPassword,onChange:e=>L(e.target.value),variant:"bordered",isDisabled:!q,placeholder:"Dejar vac\xedo para no cambiar",endContent:(0,s.jsx)("button",{type:"button",onClick:()=>E(!A),className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:A?(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,s.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})}),v&&f.newPassword&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Fuerza de contrase\xf1a:"}),(0,s.jsx)("span",{className:"font-medium ".concat(v.strength<40?"text-red-600":v.strength<70?"text-yellow-600":"text-green-600"),children:(e=>e<40?"D\xe9bil":e<70?"Media":"Fuerte")(v.strength)})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat((e=>e<40?"bg-red-500":e<70?"bg-yellow-500":"bg-green-500")(v.strength)),style:{width:"".concat(v.strength,"%")}})})]})]}),(0,s.jsx)(m.r,{label:"Confirmar contrase\xf1a",type:A?"text":"password",value:f.confirmPassword,onChange:e=>P(e.target.value),variant:"bordered",isDisabled:!q||!f.newPassword,placeholder:"Confirmar nueva contrase\xf1a",isInvalid:!!w,errorMessage:w,endContent:(0,s.jsx)("button",{type:"button",onClick:()=>E(!A),className:"text-gray-400 hover:text-gray-600 focus:outline-none",disabled:!f.newPassword,children:A?(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,s.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})})]}),v&&f.newPassword&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Requisitos:"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[{key:"length",label:"8+ caracteres"},{key:"uppercase",label:"May\xfascula (A-Z)"},{key:"lowercase",label:"Min\xfascula (a-z)"},{key:"number",label:"N\xfamero (0-9)"},{key:"special",label:"Car\xe1cter especial"}].map(e=>{let{key:a,label:r}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[v.checks[a]?(0,s.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,s.jsx)("span",{className:v.checks[a]?"text-green-700 dark:text-green-400":"text-gray-500",children:r})]},a)})})]}),f.newPassword&&f.confirmPassword&&(0,s.jsx)("div",{className:"mt-3 flex items-center gap-2 text-sm",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,s.jsx)("span",{className:"text-red-600",children:"Las contrase\xf1as no coinciden"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,s.jsx)("span",{className:"text-green-600",children:"Las contrase\xf1as coinciden"})]})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mt-4",children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Informaci\xf3n adicional"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Creado:"}),(0,s.jsx)("p",{children:new Date(n.createdAt).toLocaleDateString("es-ES")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"\xdaltimo acceso:"}),(0,s.jsx)("p",{children:n.lastLogin?new Date(n.lastLogin).toLocaleDateString("es-ES"):"Nunca"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"2FA:"}),(0,s.jsx)("p",{children:n.twoFactorEnabled?"Activado":"Desactivado"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Estado:"}),(0,s.jsx)("p",{className:n.accountLocked?"text-red-600":"text-green-600",children:n.accountLocked?"Bloqueado":"Activo"})]})]})]})]}),(0,s.jsxs)(g.q,{children:[(0,s.jsx)(p.T,{variant:"light",onPress:r,children:"Cancelar"}),(0,s.jsx)(p.T,{color:"primary",type:"submit",isLoading:i,isDisabled:!!(!q||f.newPassword&&(!(null==v?void 0:v.isValid)||w)),startContent:!i&&(0,s.jsx)(T.A,{className:"w-4 h-4"}),children:i?"Guardando...":"Guardar Cambios"})]})]})]})})};function Z(){let{user:e}=(0,i.As)(),[a,r]=(0,t.useState)([]),[O,T]=(0,t.useState)(!0),[Y,Z]=(0,t.useState)(""),[Q,$]=(0,t.useState)(""),[ee,ea]=(0,t.useState)(new Set([])),[er,es]=(0,t.useState)(!1),[et,el]=(0,t.useState)(!1),{isOpen:ei,onOpen:en,onClose:eo}=(0,b.j)(),{isOpen:ec,onOpen:ed,onClose:eu}=(0,b.j)(),{isOpen:em,onOpen:ex,onClose:eh}=(0,b.j)(),{isOpen:eg,onOpen:ep,onClose:ey}=(0,b.j)(),[eb,ej]=(0,t.useState)(null),[ef,eN]=(0,t.useState)(null),[ev,ek]=(0,t.useState)({density:"normal",view:"table",visibleColumns:new Set(["user","role","status","lastLogin","actions"]),sortConfig:{column:"name",direction:"ascending"},filters:{global:"",role:"ALL",status:"ALL"},pagination:{page:1,itemsPerPage:10}}),ew=(0,t.useCallback)(async()=>{try{T(!0),Z("");let e=await fetch("/api/users"),a=await e.json();a.success?r(a.users):Z(a.message||"Error cargando usuarios")}catch(e){console.warn("Error loading users:",Y),Z("Error de conexi\xf3n")}finally{T(!1)}},[]),eC=async e=>{es(!0),Z("");try{let a=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await a.json();r.success?(V.oR.success("Usuario invitado exitosamente. Contrase\xf1a temporal: ".concat(r.tempPassword)),eo(),ew()):(Z(r.message||"Error invitando usuario"),V.oR.error(r.message||"Error invitando usuario"))}catch(e){console.warn("Error inviting user:",Y),Z("Error de conexi\xf3n"),V.oR.error("Error de conexi\xf3n")}finally{es(!1)}},eA=async e=>{try{let a=await fetch("/api/users/".concat(e),{method:"DELETE"}),r=await a.json();r.success?(V.oR.success("Usuario eliminado exitosamente"),ew(),eu()):Z(r.message||"Error eliminando usuario")}catch(e){console.warn("Error deleting user:",Y),Z("Error de conexi\xf3n")}},eE=async(e,a)=>{el(!0),Z("");try{let r=await fetch("/api/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s=await r.json();s.success?(V.oR.success("Usuario actualizado exitosamente"),ey(),ew()):(Z(s.message||"Error actualizando usuario"),V.oR.error(s.message||"Error actualizando usuario"))}catch(e){console.warn("Error updating user:",Y),Z("Error de conexi\xf3n"),V.oR.error("Error de conexi\xf3n")}finally{el(!1)}},eL=async(e,a)=>{if(0!==a.length)try{let r=await fetch("/api/users/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,userIds:a.map(e=>e.id)})}),s=await r.json();s.success?(V.oR.success("Acci\xf3n ".concat(e," aplicada a ").concat(a.length," usuarios")),ew(),ea(new Set([]))):Z(s.message||"Error en acci\xf3n masiva")}catch(e){console.warn("Error in bulk action:",Y),Z("Error de conexi\xf3n")}},eP=e=>{switch(e){case"ADMIN":return(0,s.jsx)(q.A,{className:"w-4 h-4"});case"MANAGER":return(0,s.jsx)(R.A,{className:"w-4 h-4"});default:return(0,s.jsx)(D.A,{className:"w-4 h-4"})}},eS=e=>{switch(e){case"ADMIN":return"danger";case"MANAGER":return"primary";default:return"default"}},eM=e=>{switch(e){case"ADMIN":return"Administrador";case"MANAGER":return"Manager";default:return"Usuario"}},eI=(0,t.useCallback)(e=>e.firstName&&e.lastName?"".concat(e.firstName[0]).concat(e.lastName[0]).toUpperCase():e.name?e.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):e.email[0].toUpperCase(),[]),eO=(0,t.useCallback)(e=>e.firstName&&e.lastName?"".concat(e.firstName," ").concat(e.lastName):e.name?e.name:e.email,[]),eT=(null==e?void 0:e.role)==="ADMIN",eq=(null==e?void 0:e.role)==="MANAGER",eR=eT||eq,eD=(0,t.useMemo)(()=>{let e=[...a];if(ev.filters.global){let a=ev.filters.global.toLowerCase();e=e.filter(e=>{var r;return(e.firstName&&e.lastName?"".concat(e.firstName," ").concat(e.lastName).toLowerCase():(null==(r=e.name)?void 0:r.toLowerCase())||e.email.toLowerCase()).includes(a)||e.email.toLowerCase().includes(a)||e.firstName&&e.firstName.toLowerCase().includes(a)||e.lastName&&e.lastName.toLowerCase().includes(a)})}return"ALL"!==ev.filters.role&&(e=e.filter(e=>e.role===ev.filters.role)),"ALL"!==ev.filters.status&&("ACTIVE"===ev.filters.status?e=e.filter(e=>!e.accountLocked):"LOCKED"===ev.filters.status&&(e=e.filter(e=>e.accountLocked))),ev.sortConfig.column&&e.sort((e,a)=>{let r,s;return("name"===ev.sortConfig.column?(r=e.firstName&&e.lastName?"".concat(e.firstName," ").concat(e.lastName):e.name||e.email,s=a.firstName&&a.lastName?"".concat(a.firstName," ").concat(a.lastName):a.name||a.email):(r=e[ev.sortConfig.column]||"",s=a[ev.sortConfig.column]||""),"ascending"===ev.sortConfig.direction)?r<s?-1:+(r>s):r>s?-1:+(r<s)}),e},[a,ev.filters,ev.sortConfig]),eU=(0,t.useMemo)(()=>{let e=(ev.pagination.page-1)*ev.pagination.itemsPerPage,a=e+ev.pagination.itemsPerPage;return eD.slice(e,a)},[eD,ev.pagination]),ez=Math.ceil(eD.length/ev.pagination.itemsPerPage),e_=(0,t.useMemo)(()=>"all"===ee?eU:eU.filter(e=>ee.has(e.id)),[ee,eU]),eB=(0,t.useCallback)((e,a)=>{switch(a){case"user":return(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(j.Q,{name:eI(e),size:"sm",className:"flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:eO(e)}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]})]});case"role":return(0,s.jsx)(f.R,{color:eS(e.role),variant:"flat",size:"sm",startContent:eP(e.role),children:eM(e.role)});case"status":return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.R,{color:e.accountLocked?"danger":"success",variant:"flat",size:"sm",children:e.accountLocked?"Bloqueado":"Activo"}),e.twoFactorEnabled&&(0,s.jsx)(N.I,{content:"2FA Activado",children:(0,s.jsx)(q.A,{className:"w-4 h-4 text-green-500"})})]});case"lastLogin":return(0,s.jsx)("span",{className:"text-sm text-gray-500",children:e.lastLogin?new Date(e.lastLogin).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"Nunca"});case"actions":return eR?(0,s.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[(0,s.jsx)(p.T,{isIconOnly:!0,size:"sm",variant:"light",color:"primary",onPress:()=>{eN(e),ep()},"aria-label":"Editar usuario",children:(0,s.jsx)(U.A,{className:"w-4 h-4"})}),(0,s.jsx)(p.T,{isIconOnly:!0,size:"sm",variant:"light",color:"danger",onPress:()=>{ej(e),ed()},"aria-label":"Eliminar usuario",children:(0,s.jsx)(z.A,{className:"w-4 h-4"})})]}):(0,s.jsx)("span",{className:"text-sm text-gray-400 text-center",children:"-"});default:return null}},[eR,ed,ep]);(0,t.useEffect)(()=>{ew()},[ew]),(0,t.useEffect)(()=>{if(Y||Q){let e=setTimeout(()=>{Z(""),$("")},5e3);return()=>clearTimeout(e)}},[Y,Q]);let eK=[{key:"user",label:"Usuario",sortable:!0},{key:"role",label:"Rol",sortable:!0},{key:"status",label:"Estado",sortable:!1},{key:"lastLogin",label:"\xdaltimo acceso",sortable:!0},...eR?[{key:"actions",label:"Acciones",sortable:!1}]:[]],eV=(0,t.useMemo)(()=>eK.filter(e=>ev.visibleColumns.has(e.key)),[eK,ev.visibleColumns]);return O?(0,s.jsx)(F.Ay,{variant:"page",message:"Cargando equipo...",size:"lg"}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Gesti\xf3n de Equipo"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Administra los miembros de tu equipo y sus permisos"})]}),eR&&(0,s.jsx)(p.T,{color:"primary",onPress:en,startContent:(0,s.jsx)(_.A,{className:"w-4 h-4"}),children:"Invitar Usuario"})]}),(0,s.jsxs)(n.N,{children:[Y&&(0,s.jsx)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:Y})}),Q&&(0,s.jsx)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:Q})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[(0,s.jsx)(m.r,{placeholder:"Buscar usuarios...",value:ev.filters.global,onChange:e=>ek(a=>({...a,filters:{...a.filters,global:e.target.value}})),startContent:(0,s.jsx)(B.A,{className:"w-4 h-4"}),className:"w-full sm:max-w-xs",variant:"bordered"}),(0,s.jsx)(x.d,{placeholder:"Filtrar por rol",selectedKeys:[ev.filters.role],onSelectionChange:e=>ek(a=>({...a,filters:{...a.filters,role:Array.from(e)[0]}})),className:"w-full sm:w-48",variant:"bordered",children:G.map(e=>(0,s.jsx)(h.y,{children:e.label},e.value))}),(0,s.jsx)(x.d,{placeholder:"Filtrar por estado",selectedKeys:[ev.filters.status],onSelectionChange:e=>ek(a=>({...a,filters:{...a.filters,status:Array.from(e)[0]}})),className:"w-full sm:w-48",variant:"bordered",children:W.map(e=>(0,s.jsx)(h.y,{children:e.label},e.value))})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e_.length>0&&eR&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:[e_.length," seleccionados"]}),(0,s.jsxs)(v.A,{children:[(0,s.jsx)(k.b,{children:(0,s.jsx)(p.T,{variant:"flat",size:"sm",children:"Acciones"})}),(0,s.jsxs)(w.y,{children:[(0,s.jsx)(C.Y,{onPress:()=>eL("activate",e_),children:"Activar usuarios"},"activate"),(0,s.jsx)(C.Y,{onPress:()=>eL("deactivate",e_),children:"Desactivar usuarios"},"deactivate"),(0,s.jsx)(C.Y,{onPress:()=>eL("export",e_),children:"Exportar selecci\xf3n"},"export")]})]})]}),(0,s.jsx)(p.T,{isIconOnly:!0,variant:"light",onPress:ex,children:(0,s.jsx)(U.A,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:a.length}),(0,s.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Total usuarios"})]}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:a.filter(e=>!e.accountLocked).length}),(0,s.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Usuarios activos"})]}),(0,s.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:a.filter(e=>"ADMIN"===e.role).length}),(0,s.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:"Administradores"})]}),(0,s.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:a.filter(e=>e.twoFactorEnabled).length}),(0,s.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Con 2FA activo"})]})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsxs)(A.j,{"aria-label":"Tabla de gesti\xf3n de equipo",selectionMode:eR?"multiple":"none",selectedKeys:ee,onSelectionChange:ea,sortDescriptor:ev.sortConfig,onSortChange:e=>ek(a=>({...a,sortConfig:e})),className:"min-h-[400px]",classNames:{wrapper:"min-h-[400px] p-0 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm bg-white dark:bg-gray-800",table:"table-auto",th:"bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-semibold text-sm border-b border-gray-200 dark:border-gray-600",td:"compact"===ev.density?"py-3 px-4":"comfortable"===ev.density?"py-5 px-4":"py-4 px-4",tr:"hover:bg-gray-50 dark:hover:bg-gray-700/50 border-b border-gray-100 dark:border-gray-700 last:border-b-0"},children:[(0,s.jsx)(E.X,{columns:eV,children:e=>(0,s.jsx)(L.e,{allowsSorting:e.sortable,className:"".concat("actions"===e.key?"text-center w-48":""," ").concat("user"===e.key?"min-w-[250px]":""),children:e.label},e.key)}),(0,s.jsx)(P.E,{items:eU,emptyContent:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(D.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:ev.filters.global||"ALL"!==ev.filters.role||"ALL"!==ev.filters.status?"No se encontraron usuarios":"No hay usuarios en el equipo"}),(0,s.jsx)("p",{className:"text-gray-500",children:ev.filters.global||"ALL"!==ev.filters.role||"ALL"!==ev.filters.status?"Intenta ajustar los filtros para encontrar lo que buscas":"Invita a tu primer miembro del equipo para comenzar"})]}),children:e=>(0,s.jsx)(S.s,{children:a=>(0,s.jsx)(M.w,{children:eB(e,a)})},e.id)})]}),ez>1&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Mostrando ",(ev.pagination.page-1)*ev.pagination.itemsPerPage+1," a"," ",Math.min(ev.pagination.page*ev.pagination.itemsPerPage,eD.length)," de"," ",eD.length," usuarios"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(x.d,{size:"sm",variant:"bordered",selectedKeys:[ev.pagination.itemsPerPage.toString()],onSelectionChange:e=>{let a=parseInt(Array.from(e)[0]);ek(e=>({...e,pagination:{...e.pagination,itemsPerPage:a,page:1}}))},className:"w-40","aria-label":"Elementos por p\xe1gina",children:J.map(e=>(0,s.jsx)(h.y,{children:e.label},e.value.toString()))}),(0,s.jsx)(I.T,{total:ez,page:ev.pagination.page,onChange:e=>ek(a=>({...a,pagination:{...a.pagination,page:e}})),size:"sm",showControls:!0,showShadow:!0,color:"primary",className:"gap-2"})]})]})]}),(0,s.jsx)(H,{isOpen:ei,onClose:eo,onInvite:eC,loading:er}),(0,s.jsx)(X,{isOpen:eg,onClose:ey,onUpdate:eE,loading:et,user:ef,currentUserRole:(null==e?void 0:e.role)||"USER",currentUser:e}),(0,s.jsx)(o.Y,{isOpen:ec,onClose:eu,children:(0,s.jsxs)(c.g,{children:[(0,s.jsx)(d.c,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(K.A,{className:"w-6 h-6 text-red-500"}),(0,s.jsx)("span",{children:"Confirmar eliminaci\xf3n"})]})}),(0,s.jsxs)(u.h,{children:[(0,s.jsxs)("p",{children:["\xbfEst\xe1s seguro de que deseas eliminar a"," ",(0,s.jsx)("strong",{children:eb?eO(eb):""}),"?"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Esta acci\xf3n no se puede deshacer."})]}),(0,s.jsxs)(g.q,{children:[(0,s.jsx)(p.T,{variant:"light",onPress:eu,children:"Cancelar"}),(0,s.jsx)(p.T,{color:"danger",onPress:()=>{eb&&eA(eb.id)},children:"Eliminar"})]})]})}),(0,s.jsx)(o.Y,{isOpen:em,onClose:eh,children:(0,s.jsxs)(c.g,{children:[(0,s.jsx)(d.c,{children:"Configuraci\xf3n de tabla"}),(0,s.jsx)(u.h,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Densidad"}),(0,s.jsxs)(x.d,{selectedKeys:[ev.density],onSelectionChange:e=>ek(a=>({...a,density:Array.from(e)[0]})),variant:"bordered",children:[(0,s.jsx)(h.y,{children:"Compacta"},"compact"),(0,s.jsx)(h.y,{children:"Normal"},"normal"),(0,s.jsx)(h.y,{children:"C\xf3moda"},"comfortable")]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Columnas visibles"}),(0,s.jsx)("div",{className:"space-y-2",children:eK.map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(y.Z,{size:"sm",isSelected:ev.visibleColumns.has(e.key),onValueChange:a=>{let r=new Set(ev.visibleColumns);a?r.add(e.key):r.delete(e.key),ek(e=>({...e,visibleColumns:r}))}}),(0,s.jsx)("span",{className:"ml-2 text-sm",children:e.label})]},e.key))})]})]})}),(0,s.jsx)(g.q,{children:(0,s.jsx)(p.T,{variant:"light",onPress:eh,children:"Cerrar"})})]})})]})}var Q=r(19776),$=r(85812),ee=r(86474),ea=r(65529),er=r(5500),es=r(18593),et=r(94038);let el=[{id:"openai",name:"OpenAI",icon:ee.A},{id:"hubspot",name:"HubSpot",icon:ea.A},{id:"clearbit",name:"Clearbit",icon:er.A},{id:"hunterio",name:"Hunter.io",icon:es.A},{id:"mailboxlayer",name:"MailboxLayer",icon:et.A}],ei={openai:[{key:"OPENAI_API_KEY",label:"API Key",type:"password",help:"Clave secreta de OpenAI (sk-...)",required:!0},{key:"OPENAI_MODEL",label:"Modelo",type:"text",help:"Ej: gpt-4o",required:!0},{key:"OPENAI_TEMPERATURE",label:"Temperatura",type:"number",help:"Creatividad (0-1)",required:!0},{key:"OPENAI_MAX_TOKENS",label:"M\xe1x. Tokens",type:"number",help:"L\xedmite de tokens por respuesta",required:!0},{key:"OPENAI_IS_ACTIVE",label:"Activo",type:"checkbox",help:"Habilitar integraci\xf3n",required:!1}],hubspot:[{key:"HUBSPOT_API_KEY",label:"API Key",type:"password",help:"Token privado de HubSpot",required:!0},{key:"HUBSPOT_ENV",label:"Ambiente",type:"text",help:"production, sandbox, etc.",required:!0},{key:"HUBSPOT_ACCOUNT_NAME",label:"Nombre de cuenta",type:"text",help:"Identificador de la cuenta",required:!1}],clearbit:[{key:"CLEARBIT_API_KEY",label:"API Key",type:"password",help:"Clave de Clearbit",required:!0},{key:"CLEARBIT_NAME",label:"Nombre",type:"text",help:"Nombre de integraci\xf3n",required:!1}],hunterio:[{key:"HUNTERIO_API_KEY",label:"API Key",type:"password",help:"Clave de Hunter.io",required:!0},{key:"HUNTERIO_NAME",label:"Nombre",type:"text",help:"Nombre de integraci\xf3n",required:!1}],mailboxlayer:[{key:"MAILBOXLAYER_API_KEY",label:"API Key",type:"password",help:"Clave de MailboxLayer",required:!0},{key:"MAILBOXLAYER_NAME",label:"Nombre",type:"text",help:"Nombre de integraci\xf3n",required:!1}]};function en(e){let{isAdmin:a}=e,[r,l]=(0,t.useState)("openai"),[i,n]=(0,t.useState)({}),[o,c]=(0,t.useState)(!0),[d,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(null),[h,g]=(0,t.useState)(null);(0,t.useEffect)(()=>{p()},[]);let p=async()=>{c(!0),x(null);try{let e=await fetch("/api/settings/apis");if(401===e.status)return void x("No tienes permisos para acceder a esta configuraci\xf3n. Solo los administradores pueden ver y editar las APIs.");if(403===e.status)return void x("Acceso denegado. Se requieren permisos de administrador.");if(!e.ok)throw Error("Error ".concat(e.status,": ").concat(e.statusText));let a=await e.json();if(a.success){let e={};a.configs.forEach(a=>{e[a.key]=a.value,a.isEncrypted&&(e["".concat(a.key,"_hasValue")]=a.hasValue)}),n(e)}else x(a.error||"Error al cargar configuraci\xf3n")}catch(e){console.warn("Error fetching configs:",e),x("Error de conexi\xf3n. Verifica que el servidor est\xe9 funcionando.")}finally{c(!1)}},y=(e,a)=>{n(r=>({...r,[e]:a}))},b=async()=>{u(!0),x(null),g(null);try{let e=ei[r].map(e=>({key:e.key,value:i[e.key]||"",isEncrypted:"password"===e.type})).filter(e=>!e.isEncrypted||!!e.value||!i["".concat(e.key,"_hasValue")]),a=await fetch("/api/settings/apis",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await a.json();s.success?(g("Configuraci\xf3n guardada correctamente"),p()):x(s.error||"Error al guardar")}catch(e){x("Error de red")}finally{u(!1)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(Q.r,{selectedKey:r,onSelectionChange:e=>l(e),className:"mb-6",children:el.map(e=>(0,s.jsx)($.i,{title:(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(e.icon,{className:"w-5 h-5 mr-2"}),e.name]})},e.id))}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-100 dark:border-gray-700",children:o?(0,s.jsx)("div",{className:"text-center text-gray-500",children:"Cargando configuraci\xf3n..."}):(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b()},className:"space-y-6",children:[ei[r].map(e=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.label,e.required&&(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),"checkbox"===e.type?(0,s.jsx)("input",{type:"checkbox",checked:!!i[e.key]&&"false"!==i[e.key],onChange:a=>y(e.key,a.target.checked?"true":"false"),className:"w-5 h-5 text-blue-600 rounded",disabled:!a}):(0,s.jsx)("input",{type:e.type,value:i[e.key]||"",onChange:a=>y(e.key,a.target.value),placeholder:"password"===e.type&&i["".concat(e.key,"_hasValue")]?"API Key configurada (oculta por seguridad)":e.help,className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:!a}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"password"===e.type&&i["".concat(e.key,"_hasValue")]?"Deja vac\xedo para mantener la clave actual":e.help})]},e.key)),m&&(0,s.jsx)("div",{className:"text-red-600 text-sm",children:m}),h&&(0,s.jsx)("div",{className:"text-green-600 text-sm",children:h}),a&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",disabled:d,children:d?"Guardando...":"Guardar"})}),!a&&(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Solo los administradores pueden editar la configuraci\xf3n de APIs."})]})})]})}var eo=r(58828),ec=r(12513);let ed=[{id:"profile",name:"Perfil",icon:D.A},{id:"apis",name:"APIs",icon:et.A},{id:"notifications",name:"Notificaciones",icon:eo.A},{id:"security",name:"Seguridad",icon:q.A},{id:"team",name:"Equipo",icon:ec.A}];function eu(){let[e,a]=(0,t.useState)("profile"),{user:r}=(0,i.As)();return r?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Configuraci\xf3n"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Gestiona tu cuenta y las preferencias de la aplicaci\xf3n"})]}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-xl overflow-hidden",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"w-64 border-r border-gray-100 dark:border-gray-700",children:(0,s.jsx)("nav",{className:"p-4 space-y-1",children:ed.map(r=>(0,s.jsxs)("button",{onClick:()=>a(r.id),className:"w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat(e===r.id?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"),children:[(0,s.jsx)(r.icon,{className:"w-5 h-5 mr-3"}),r.name]},r.id))})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},className:"p-6",children:(()=>{switch(e){case"profile":return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Informaci\xf3n Personal"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre"}),(0,s.jsx)("input",{type:"text",defaultValue:r.name||"",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",defaultValue:r.email||"",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Empresa"}),(0,s.jsx)("input",{type:"text",defaultValue:"Prospecter Inc.",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cargo"}),(0,s.jsx)("input",{type:"text",defaultValue:"ADMIN"===r.role?"Administrador":"Usuario",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Guardar Cambios"})})]});case"apis":return(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Configuraci\xf3n de APIs"}),(0,s.jsx)(en,{isAdmin:"ADMIN"===r.role})]})});case"notifications":return(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Preferencias de Notificaciones"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Nuevos leads"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recibir notificaci\xf3n cuando se agregue un nuevo lead"})]}),(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"w-4 h-4 text-blue-600 rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Enriquecimiento completado"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Notificar cuando se complete el enriquecimiento de datos"})]}),(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"w-4 h-4 text-blue-600 rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Reportes semanales"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recibir resumen semanal de actividad"})]}),(0,s.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 rounded"})]})]})]})});case"security":return(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Configuraci\xf3n de Seguridad"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Cambiar Contrase\xf1a"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("input",{type:"password",placeholder:"Contrase\xf1a actual",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,s.jsx)("input",{type:"password",placeholder:"Nueva contrase\xf1a",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,s.jsx)("input",{type:"password",placeholder:"Confirmar nueva contrase\xf1a",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,s.jsx)("button",{className:"mt-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Actualizar Contrase\xf1a"})]}),(0,s.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Autenticaci\xf3n de Dos Factores"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"A\xf1ade una capa extra de seguridad a tu cuenta"}),(0,s.jsx)("button",{onClick:()=>window.location.href="/settings/security",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"Configurar 2FA"})]})]})]})});case"team":return(0,s.jsx)(Z,{});default:return(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Secci\xf3n en desarrollo..."})})}})()},e)})]})})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Cargando configuraci\xf3n..."})})}},40283:(e,a,r)=>{"use strict";r.d(a,{As:()=>c,OJ:()=>o});var s=r(95155),t=r(12115),l=r(45493);let i=(0,t.createContext)(void 0);function n(e){let{children:a}=e,{data:r,status:n}=(0,l.wV)(),[o,c]=(0,t.useState)(!1),[d,u]=(0,t.useState)(null),m=(null==r?void 0:r.user)?{id:r.user.id,name:r.user.name,email:r.user.email,image:r.user.image||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(r.user.name||r.user.email||""),"&background=3b82f6&color=ffffff"),role:r.user.role||"user",lastLogin:r.user.lastLogin?new Date(r.user.lastLogin):void 0}:null,x="loading"===n,h=async(e,a)=>{try{let r=await fetch("/api/auth/check-2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),s=!1;r.ok&&(s=(await r.json()).has2FA);let t=await (0,l.Jv)("credentials",{email:e,password:a,redirect:!1});if(null==t?void 0:t.error){if(s&&"CredentialsSignin"===t.error)return c(!0),u(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!1,error:"CredentialsSignin"===t.error?"Credenciales inv\xe1lidas":t.error}}if(s)return c(!0),u(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!0}}catch(e){return{success:!1,error:"Error al iniciar sesi\xf3n"}}},g=async(e,a)=>{try{let r=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,token:a})});if(!r.ok){let e=await r.json();return{success:!1,error:e.message||"C\xf3digo 2FA inv\xe1lido"}}let s=await (0,l.Jv)("credentials",{email:e,token:a,redirect:!1});if(null==s?void 0:s.error)return{success:!1,error:"Error completando autenticaci\xf3n"};return c(!1),u(null),{success:!0}}catch(e){return{success:!1,error:"Error verificando 2FA"}}},p=async(e,a,r)=>{try{let s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:a,password:r})});if(!s.ok){let e=await s.json();return{success:!1,error:e.message||"Error al crear la cuenta"}}return await h(a,r)}catch(e){return{success:!1,error:"Error al crear la cuenta"}}},y=async e=>{try{let a=await (0,l.Jv)(e,{redirect:!1});if(null==a?void 0:a.error)return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)};return{success:!0}}catch(a){return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)}}},b=async()=>{c(!1),u(null),await (0,l.CI)({redirect:!1})},j=async e=>{try{if(!(await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)return{success:!1,error:"Error al enviar email de recuperaci\xf3n"};return{success:!0}}catch(e){return{success:!1,error:"Error al procesar solicitud de recuperaci\xf3n"}}};return(0,s.jsx)(i.Provider,{value:{user:m,loading:x,isLoading:x,requires2FA:o,pending2FAEmail:d,login:h,verify2FA:g,register:p,logout:b,socialLogin:y,resetPassword:j,session:r},children:a})}function o(e){let{children:a}=e;return(0,s.jsx)(l.CP,{children:(0,s.jsx)(n,{children:a})})}function c(){let e=(0,t.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var a=a=>e(e.s=a);e.O(0,[545,71,493,907,156,274,607,134,373,968,441,684,358],()=>a(12280)),_N_E=e.O()}]);