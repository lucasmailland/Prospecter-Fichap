(()=>{var e={};e.id=393,e.ids=[393],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27576:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(60687),s=r(88920),n=r(11468),i=r(81836);function o({isOpen:e,onClose:t,title:r,children:o,size:d="md",showCloseButton:l=!0}){return(0,a.jsx)(s.N,{children:e&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,a.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)(n.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:`relative w-full ${sizeClasses[d]} bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-100 dark:border-gray-700`,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 dark:border-gray-700",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r}),l&&(0,a.jsx)("button",{onClick:t,className:"p-1 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,a.jsx)(i.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"px-6 py-4",children:o})]})})]})})}},28027:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/settings/security/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/settings/security/page.tsx","default")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},49846:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>g,pages:()=>c,routeModule:()=>u,tree:()=>l});var a=r(65239),s=r(48088),n=r(88170),i=r.n(n),o=r(30893),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let l={children:["",{children:["settings",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,28027)),"/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/settings/security/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,54413)),"/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/lucasmailland/Desktop/Prospecter-Fichap/frontend/src/app/settings/security/page.tsx"],g={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/settings/security/page",pathname:"/settings/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},50942:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(43210);let s=a.forwardRef(function({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))})},54464:(e,t,r)=>{"use strict";r.d(t,{UI:()=>a,mY:()=>s});let a={spacing:{card:"p-6",cardHeader:"px-6 pt-6 pb-4",cardContent:"p-6",section:"space-y-8",item:"space-y-4"},typography:{h1:"text-2xl font-semibold text-gray-900 dark:text-white tracking-tight",h2:"text-lg font-semibold text-gray-900 dark:text-white tracking-tight",h3:"text-base font-medium text-gray-900 dark:text-white",body:"text-sm text-gray-600 dark:text-gray-400 font-normal",caption:"text-xs text-gray-500 dark:text-gray-500",value:"text-xl font-semibold text-gray-900 dark:text-white tracking-tight",metric:"text-2xl font-semibold text-gray-900 dark:text-white tracking-tight"},colors:{success:{bg:"bg-green-50 dark:bg-green-950/20",border:"border-green-200 dark:border-green-800/30",text:"text-green-800 dark:text-green-300",icon:"text-green-700 dark:text-green-400",dot:"bg-green-600"},warning:{bg:"bg-yellow-50 dark:bg-yellow-950/20",border:"border-yellow-200 dark:border-yellow-800/30",text:"text-yellow-800 dark:text-yellow-300",icon:"text-yellow-700 dark:text-yellow-400",dot:"bg-yellow-600"},danger:{bg:"bg-red-50 dark:bg-red-950/20",border:"border-red-200 dark:border-red-800/30",text:"text-red-800 dark:text-red-300",icon:"text-red-700 dark:text-red-400",dot:"bg-red-600"},info:{bg:"bg-blue-50 dark:bg-blue-950/20",border:"border-blue-200 dark:border-blue-800/30",text:"text-blue-800 dark:text-blue-300",icon:"text-blue-700 dark:text-blue-400",dot:"bg-blue-600"},neutral:{bg:"bg-gray-50 dark:bg-gray-800",border:"border-gray-100 dark:border-gray-700",text:"text-gray-600 dark:text-gray-300",icon:"text-gray-400 dark:text-gray-500",dot:"bg-gray-300 dark:bg-gray-600"}},card:{base:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-xl",hover:"hover:shadow-sm transition-shadow duration-200",interactive:"hover:bg-gray-50/50 dark:hover:bg-gray-700/20 transition-colors"},button:{primary:"px-4 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 hover:bg-gray-800 dark:hover:bg-gray-200 rounded-lg text-sm font-medium transition-colors",secondary:"px-4 py-2 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg text-sm font-medium transition-colors",ghost:"px-3 py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-sm font-medium transition-colors"},input:{base:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"},metrics:{positive:"text-emerald-700 dark:text-emerald-400 font-bold",negative:"text-red-700 dark:text-red-400 font-bold",neutral:"text-gray-600 dark:text-gray-400 font-semibold"},leadStatus:{qualified:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-900 dark:text-emerald-200",dot:"bg-emerald-600"},potential:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-900 dark:text-amber-200",dot:"bg-amber-600"},cold:{bg:"bg-gray-100 dark:bg-gray-700",text:"text-gray-600 dark:text-gray-300",dot:"bg-gray-400"},hot:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-900 dark:text-red-200",dot:"bg-red-600"},warm:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-900 dark:text-orange-200",dot:"bg-orange-600"}},score:{excellent:"text-emerald-700 dark:text-emerald-400 font-bold",good:"text-blue-700 dark:text-blue-400 font-bold",fair:"text-amber-700 dark:text-amber-400 font-bold",poor:"text-red-700 dark:text-red-400 font-bold"},progressBar:{excellent:"bg-emerald-600",good:"bg-blue-600",fair:"bg-amber-600",poor:"bg-red-600",success:"bg-emerald-600",warning:"bg-amber-600",danger:"bg-red-600",neutral:"bg-gray-300"}},s={flexCenter:"flex items-center justify-center",flexBetween:"flex items-center justify-between",flexStart:"flex items-start",flexCol:"flex flex-col",flexColCenter:"flex flex-col items-center justify-center",buttonPrimary:"bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white font-semibold rounded-lg transition-all duration-200",buttonSecondary:"border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors",buttonDanger:"bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-colors",card:"bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-100 dark:border-gray-700",cardPadding:"p-6",input:"w-full px-4 py-3 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",loading:"animate-pulse bg-gray-200 dark:bg-gray-700 rounded",disabled:"opacity-50 cursor-not-allowed",textMuted:"text-gray-600 dark:text-gray-400",textPrimary:"text-gray-900 dark:text-white",textSecondary:"text-gray-700 dark:text-gray-300",section:"space-y-6",stack:"space-y-4",inlineStack:"space-x-4",transition:"transition-all duration-200",fadeIn:"animate-in fade-in-0 duration-200",slideIn:"animate-in slide-in-from-bottom-4 duration-200"}},58089:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(43210);let s=a.forwardRef(function({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79149:(e,t,r)=>{Promise.resolve().then(r.bind(r,97136))},79551:e=>{"use strict";e.exports=require("url")},81146:(e,t,r)=>{"use strict";let a=r(93499),s=["http:","https:","mailto:","tel:"],n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function i(e){return"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}function o(e){if("string"!=typeof e)return"";try{let t=new URL(e);if(!s.includes(t.protocol))return"";return e}catch{return i(e)}}function d(e){if("string"!=typeof e)return"";let t=e.trim().toLowerCase();return n.test(t)?t:""}e.exports={sanitizeText:i,sanitizeUrl:o,validators:{email:e=>n.test(e),phone:e=>/^[\+]?[1-9][\d]{0,15}$/.test(e.replace(/\s/g,"")),url:e=>{try{return new URL(e),!0}catch{return!1}}},escapeHtml:function(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,e=>t[e])},cn:function(...e){return a(...e).trim()},sanitizeAttribute:function(e){return"string"!=typeof e?"":e.replace(/[<>'"]/g,"").replace(/javascript:/gi,"").replace(/vbscript:/gi,"").replace(/on\w+=/gi,"").trim()},sanitizeJson:function(e){return"string"!=typeof e?"":e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")},sanitizeEmail:d,validateFormData:function(e){let t={};for(let[r,a]of Object.entries(e))"string"==typeof a?r.toLowerCase().includes("email")?t[r]=d(a):r.toLowerCase().includes("url")||r.toLowerCase().includes("website")?t[r]=o(a):t[r]=i(a):"number"==typeof a?t[r]=String(a):t[r]="";return t},sanitizeProps:function(e){let t={...e};for(let[e,r]of Object.entries(t))"string"==typeof r&&(t[e]=i(r));return t},clsx:a}},81357:(e,t,r)=>{Promise.resolve().then(r.bind(r,28027))},81836:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(43210);let s=a.forwardRef(function({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))})},88920:(e,t,r)=>{"use strict";r.d(t,{N:()=>f});var a=r(60687),s=r(43210),n=r(12157),i=r(72789),o=r(15124),d=r(21279),l=r(18171),c=r(32582);class g extends s.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,l.s)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t,anchorX:r,root:n}){let i=(0,s.useId)(),o=(0,s.useRef)(null),d=(0,s.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=(0,s.useContext)(c.Q);return(0,s.useInsertionEffect)(()=>{let{width:e,height:a,top:s,left:c,right:g}=d.current;if(t||!o.current||!e||!a)return;let u="left"===r?`left: ${c}`:`right: ${g}`;o.current.dataset.motionPopId=i;let x=document.createElement("style");l&&(x.nonce=l);let m=n??document.head;return m.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${u}px !important;
            top: ${s}px !important;
          }
        `),()=>{m.removeChild(x),m.contains(x)&&m.removeChild(x)}},[t]),(0,a.jsx)(g,{isPresent:t,childRef:o,sizeRef:d,children:s.cloneElement(e,{ref:o})})}let x=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:o,presenceAffectsLayout:l,mode:c,anchorX:g,root:x})=>{let p=(0,i.M)(m),h=(0,s.useId)(),b=!0,f=(0,s.useMemo)(()=>(b=!1,{id:h,initial:t,isPresent:r,custom:o,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;n&&n()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[r,p,n]);return l&&b&&(f={...f}),(0,s.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[r]),s.useEffect(()=>{r||p.size||!n||n()},[r]),"popLayout"===c&&(e=(0,a.jsx)(u,{isPresent:r,anchorX:g,root:x,children:e})),(0,a.jsx)(d.t.Provider,{value:f,children:e})};function m(){return new Map}var p=r(86044);let h=e=>e.key||"";function b(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let f=({children:e,custom:t,initial:r=!0,onExitComplete:d,presenceAffectsLayout:l=!0,mode:c="sync",propagate:g=!1,anchorX:u="left",root:m})=>{let[f,y]=(0,p.xQ)(g),k=(0,s.useMemo)(()=>b(e),[e]),v=g&&!f?[]:k.map(h),w=(0,s.useRef)(!0),j=(0,s.useRef)(k),N=(0,i.M)(()=>new Map),[C,A]=(0,s.useState)(k),[E,P]=(0,s.useState)(k);(0,o.E)(()=>{w.current=!1,j.current=k;for(let e=0;e<E.length;e++){let t=h(E[e]);v.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[E,v.length,v.join("-")]);let S=[];if(k!==C){let e=[...k];for(let t=0;t<E.length;t++){let r=E[t],a=h(r);v.includes(a)||(e.splice(t,0,r),S.push(r))}return"wait"===c&&S.length&&(e=S),P(b(e)),A(k),null}let{forceRender:F}=(0,s.useContext)(n.L);return(0,a.jsx)(a.Fragment,{children:E.map(e=>{let s=h(e),n=(!g||!!f)&&(k===E||v.includes(s));return(0,a.jsx)(x,{isPresent:n,initial:(!w.current||!!r)&&void 0,custom:t,presenceAffectsLayout:l,mode:c,root:m,onExitComplete:n?void 0:()=>{if(!N.has(s))return;N.set(s,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(F?.(),P(j.current),g&&y?.(),d&&d())},anchorX:u,children:e},s)})})}},93499:e=>{function t(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,a,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(a=e(t[r]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a);return s}(e))&&(a&&(a+=" "),a+=t);return a}e.exports=t,e.exports.clsx=t},97136:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(60687),s=r(30474),n=r(43210),i=r(11468),o=r(50942),d=r(58089);let l=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))});var c=r(97450),g=r(59168);let u=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))});var x=r(63213),m=r(27576),p=r(54464),h=r(81146),b=r(180);function f(){let{user:e}=(0,x.As)(),t=(e,t)=>{console.log(`${t}: ${e}`)},[r,f]=(0,n.useState)(!1),[y,k]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[C,A]=(0,n.useState)(null),[E,P]=(0,n.useState)(""),[S,F]=(0,n.useState)(""),[L,M]=(0,n.useState)(""),R=async()=>{k(!0);try{let e=await fetch("/api/auth/2fa/setup");if(!e.ok)throw Error("Error iniciando configuraci\xf3n 2FA");let t=await e.json();A(t),w(!0)}catch(e){console.warn("Error:",e),t("Error iniciando configuraci\xf3n 2FA","error")}finally{k(!1)}},Y=async()=>{if(!C||!E)return void t("Ingresa el c\xf3digo de verificaci\xf3n","warning");k(!0);try{let e=await fetch("/api/auth/2fa/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:C.secret,token:E})});if(!e.ok)throw Error("C\xf3digo de verificaci\xf3n inv\xe1lido");let r=await e.json();f(!0),w(!1),P(""),A(null),t("\xa12FA activado exitosamente!","success"),r.backupCodes&&D(r.backupCodes)}catch(e){console.warn("Error:",e),t("Error activando 2FA","error")}finally{k(!1)}},O=async()=>{if(!S)return void t("Ingresa tu contrase\xf1a actual","warning");k(!0);try{if(!(await fetch("/api/auth/2fa/disable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:S,token:L})})).ok)throw Error("Error desactivando 2FA");f(!1),N(!1),F(""),M(""),t("2FA desactivado exitosamente","info")}catch(e){console.warn("Error:",e),t("Error desactivando 2FA","error")}finally{k(!1)}},D=e=>{let r=e.join("\n");navigator.clipboard.writeText(r),t("C\xf3digos de respaldo copiados al portapapeles","success")},_=(e,r)=>{navigator.clipboard.writeText(e),t(r,"success")};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Configuraci\xf3n de Seguridad"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Protege tu cuenta con autenticaci\xf3n de dos factores y otras medidas de seguridad"})]}),(0,a.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:(0,h.cn)(p.mY.card,"mb-6"),children:(0,a.jsxs)("div",{className:p.mY.cardPadding,children:[(0,a.jsxs)("div",{className:p.mY.flexBetween,children:[(0,a.jsxs)("div",{className:p.mY.flexStart,children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg mr-4",children:(0,a.jsx)(o.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Autenticaci\xf3n de Dos Factores (2FA)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r?"Tu cuenta est\xe1 protegida con 2FA":"Agrega una capa extra de seguridad a tu cuenta"})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",children:[(0,a.jsx)(d.A,{className:"h-3 w-3 mr-1"}),"Activado"]}),(0,a.jsx)("button",{onClick:()=>N(!0),className:"px-4 py-2 text-sm font-medium text-red-600 hover:text-red-700 border border-red-300 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"Desactivar"})]}):(0,a.jsx)("button",{onClick:R,disabled:y,className:(0,h.cn)(p.mY.buttonPrimary,"px-4 py-2 text-sm",{[p.mY.disabled]:y}),children:y?(0,a.jsx)(b.Ay,{}):"Activar 2FA"})})]}),!r&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,a.jsxs)("div",{className:p.mY.flexStart,children:[(0,a.jsx)(l,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mr-2 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-300",children:"\xbfC\xf3mo funciona 2FA?"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-400 mt-1",children:"Necesitar\xe1s una app como Google Authenticator, Authy o similar en tu tel\xe9fono. Cada vez que inicies sesi\xf3n, deber\xe1s ingresar un c\xf3digo de 6 d\xedgitos."})]})]})})]})}),(0,a.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:(0,h.cn)(p.mY.card),children:(0,a.jsxs)("div",{className:p.mY.cardPadding,children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Consejos de Seguridad"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:p.mY.flexStart,children:[(0,a.jsx)(c.A,{className:"h-5 w-5 text-gray-500 mr-3 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Usa contrase\xf1as \xfanicas y seguras"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Combina letras, n\xfameros y s\xedmbolos. Nunca reutilices contrase\xf1as."})]})]}),(0,a.jsxs)("div",{className:p.mY.flexStart,children:[(0,a.jsx)(g.A,{className:"h-5 w-5 text-gray-500 mr-3 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Mant\xe9n actualizada tu informaci\xf3n"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aseg\xfarate de que tu email y tel\xe9fono est\xe9n actualizados para recuperaci\xf3n."})]})]})]})]})}),(0,a.jsx)(m.A,{isOpen:v,onClose:()=>w(!1),title:"Configurar 2FA",size:"lg",children:C&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Escanea el c\xf3digo QR"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Usa tu app de autenticaci\xf3n para escanear este c\xf3digo"}),(0,a.jsx)("div",{className:"inline-block p-4 bg-white rounded-lg",children:(0,a.jsx)(s.default,{src:C.qrCode,alt:"QR Code para 2FA",className:"w-48 h-48"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"O ingresa manualmente:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("code",{className:"flex-1 p-2 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono",children:C.manualEntryKey}),(0,a.jsx)("button",{onClick:()=>_(C.manualEntryKey,"Clave copiada"),className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:(0,a.jsx)(u,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"C\xf3digo de verificaci\xf3n"}),(0,a.jsx)("input",{type:"text",value:E,onChange:e=>P(e.target.value),placeholder:"Ingresa c\xf3digo",className:p.mY.input,maxLength:6}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Ingresa el c\xf3digo de 6 d\xedgitos de tu app"})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{onClick:()=>w(!1),className:p.mY.buttonSecondary+" flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:Y,disabled:y||!E,className:(0,h.cn)(p.mY.buttonPrimary,"flex-1",{[p.mY.disabled]:y||!E}),children:y?(0,a.jsx)(b.Ay,{}):"Activar 2FA"})]})]})}),(0,a.jsx)(m.A,{isOpen:j,onClose:()=>N(!1),title:"Desactivar 2FA",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:(0,a.jsxs)("div",{className:p.mY.flexStart,children:[(0,a.jsx)(g.A,{className:"h-5 w-5 text-red-600 dark:text-red-400 mr-2"}),(0,a.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400",children:"Desactivar 2FA reducir\xe1 la seguridad de tu cuenta"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Contrase\xf1a actual"}),(0,a.jsx)("input",{type:"password",value:S,onChange:e=>F(e.target.value),className:p.mY.input,placeholder:"Ingresa tu contrase\xf1a"})]}),r&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"C\xf3digo 2FA (opcional)"}),(0,a.jsx)("input",{type:"text",value:L,onChange:e=>M(e.target.value),className:p.mY.input,placeholder:"C\xf3digo de 6 d\xedgitos"})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{onClick:()=>N(!1),className:p.mY.buttonSecondary+" flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:O,disabled:y||!S,className:(0,h.cn)(p.mY.buttonDanger,"flex-1",{[p.mY.disabled]:y||!S}),children:y?(0,a.jsx)(b.Ay,{}):"Desactivar 2FA"})]})]})})]})})}},97450:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(43210);let s=a.forwardRef(function({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,264,566],()=>r(49846));module.exports=a})();