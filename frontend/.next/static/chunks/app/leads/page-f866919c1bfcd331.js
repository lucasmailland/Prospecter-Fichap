(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{22810:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>ei});var r=s(95155),t=s(12115),l=s(36545),i=s(83580),n=s(77347),o=s(40283),c=s(46786),d=s(8620),m=s(11846),u=s(58739),x=s(60441),g=s(3474),h=s(50766),p=s(11201),b=s(22708),y=s(21202),j=s(78447),v=s(53773),N=s(95604),f=s(58451),w=s(64177),E=s(33183),k=s(74217),A=s(39968);let C={NEW:"default",ENRICHED:"primary",VALIDATED:"secondary",PRIORITIZED:"warning",CONTACTED:"success",CONVERTED:"success",LOST:"danger"},S={NEW:"Nuevo",ENRICHED:"Enriquecido",VALIDATED:"Validado",PRIORITIZED:"Priorizado",CONTACTED:"Contactado",CONVERTED:"Convertido",LOST:"Perdido"},T=[{name:"LEAD",uid:"name",sortable:!0},{name:"EMPRESA",uid:"company",sortable:!0},{name:"CARGO",uid:"jobTitle",sortable:!0},{name:"INDUSTRIA",uid:"industry",sortable:!0},{name:"PA\xcdS",uid:"country",sortable:!0},{name:"ESTADO",uid:"status",sortable:!0},{name:"SCORE IA",uid:"score",sortable:!0},{name:"PRIORIDAD",uid:"priority",sortable:!0},{name:"FUENTE",uid:"source",sortable:!0},{name:"\xdaLTIMO CONTACTO",uid:"lastContactedAt",sortable:!0},{name:"CREADO",uid:"createdAt",sortable:!0},{name:"ACCIONES",uid:"actions"}],I=["name","company","jobTitle","status","score","priority","createdAt","actions"],L=(e,a,s,r)=>{if(e&&a)return"".concat(e.charAt(0)).concat(a.charAt(0)).toUpperCase();if(s){let e=s.split(" ");return e.length>=2?"".concat(e[0].charAt(0)).concat(e[1].charAt(0)).toUpperCase():s.charAt(0).toUpperCase()}return r?r.charAt(0).toUpperCase():"?"},D=e=>{let a=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-yellow-500","bg-red-500","bg-teal-500"],s=e.charCodeAt(0)%a.length;return a[s]},O=e=>({España:"\uD83C\uDDEA\uD83C\uDDF8","Estados Unidos":"\uD83C\uDDFA\uD83C\uDDF8",Francia:"\uD83C\uDDEB\uD83C\uDDF7",Alemania:"\uD83C\uDDE9\uD83C\uDDEA",Italia:"\uD83C\uDDEE\uD83C\uDDF9","Reino Unido":"\uD83C\uDDEC\uD83C\uDDE7",Japón:"\uD83C\uDDEF\uD83C\uDDF5",Brasil:"\uD83C\uDDE7\uD83C\uDDF7",México:"\uD83C\uDDF2\uD83C\uDDFD",Argentina:"\uD83C\uDDE6\uD83C\uDDF7",Chile:"\uD83C\uDDE8\uD83C\uDDF1",Colombia:"\uD83C\uDDE8\uD83C\uDDF4",Perú:"\uD83C\uDDF5\uD83C\uDDEA",Canada:"\uD83C\uDDE8\uD83C\uDDE6",Australia:"\uD83C\uDDE6\uD83C\uDDFA"})[e||""]||"\uD83C\uDF0D",R=e=>e>=4?{color:"danger",label:"Urgente",icon:"\uD83D\uDD25"}:e>=3?{color:"warning",label:"Alta",icon:"⚡"}:e>=2?{color:"primary",label:"Media",icon:"\uD83D\uDCCB"}:{color:"default",label:"Baja",icon:"\uD83D\uDCDD"},P=e=>({WEBSITE:{icon:"solar:global-linear",label:"Web"},API:{icon:"solar:code-linear",label:"API"},MANUAL:{icon:"solar:user-linear",label:"Manual"},IMPORT:{icon:"solar:import-linear",label:"Importado"},REFERRAL:{icon:"solar:users-group-two-rounded-linear",label:"Referido"},LINKEDIN:{icon:"solar:linkedin-linear",label:"LinkedIn"},EMAIL:{icon:"solar:letter-linear",label:"Email"}})[e||""]||{icon:"solar:question-circle-linear",label:e||"Desconocido"},M=e=>{let{leads:a=[],loading:s=!1,userRole:l=k.gG.USER,onLeadSelect:o,onLeadEdit:M,onLeadDelete:z,onBulkAction:U,onRefresh:G}=e,[F,q]=(0,t.useState)(""),[H,_]=(0,t.useState)(new Set([])),[B,V]=(0,t.useState)(new Set(I)),[W,J]=(0,t.useState)("all"),[Y,K]=(0,t.useState)(25),[Z,X]=(0,t.useState)({column:"createdAt",direction:"descending"}),[Q,$]=(0,t.useState)(1),ee=!!F,ea=(0,t.useMemo)(()=>"all"===B?T:T.filter(e=>Array.from(B).includes(e.uid)),[B]),es=(0,t.useMemo)(()=>{let e=[...a];return ee&&(e=e.filter(e=>{var a,s,r,t,l,i,n,o;return(null==(a=e.email)?void 0:a.toLowerCase().includes(F.toLowerCase()))||(null==(s=e.fullName)?void 0:s.toLowerCase().includes(F.toLowerCase()))||(null==(r=e.company)?void 0:r.toLowerCase().includes(F.toLowerCase()))||(null==(t=e.firstName)?void 0:t.toLowerCase().includes(F.toLowerCase()))||(null==(l=e.lastName)?void 0:l.toLowerCase().includes(F.toLowerCase()))||(null==(i=e.jobTitle)?void 0:i.toLowerCase().includes(F.toLowerCase()))||(null==(n=e.industry)?void 0:n.toLowerCase().includes(F.toLowerCase()))||(null==(o=e.country)?void 0:o.toLowerCase().includes(F.toLowerCase()))})),"all"!==W&&Array.from(W).length!==Object.keys(k.XN).length&&(e=e.filter(e=>Array.from(W).includes(e.status))),e},[a,F,W,ee]),er=Math.ceil(es.length/Y),et=(0,t.useMemo)(()=>{let e=(Q-1)*Y,a=e+Y;return es.slice(e,a)},[Q,es,Y]),el=(0,t.useMemo)(()=>[...et].sort((e,a)=>{let s=e[Z.column],r=a[Z.column],t=s<r?-1:+(s>r);return"descending"===Z.direction?-t:t}),[Z,et]),ei=(0,t.useMemo)(()=>"all"===H?es:es.filter(e=>H.has(e.id)),[H,es]),en=(0,t.useCallback)((e,a)=>{var s,t,m,u;let x=e.fullName||"".concat(e.firstName||""," ").concat(e.lastName||"").trim()||"Sin nombre",g=L(e.firstName,e.lastName,e.fullName,e.email),h=D(x);switch(a){case"name":return(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full ".concat(h," flex items-center justify-center text-white font-semibold text-sm"),children:g}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"text-bold text-sm capitalize",children:x}),(0,r.jsx)("p",{className:"text-bold text-xs text-default-400",children:e.email}),e.phone&&(0,r.jsx)("p",{className:"text-xs text-default-400",children:e.phone})]})]});case"company":return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"text-bold text-sm",children:e.company||"Sin empresa"}),e.companySize&&(0,r.jsxs)("p",{className:"text-xs text-default-400",children:[e.companySize," empleados"]}),e.website&&(0,r.jsxs)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline",children:[(0,r.jsx)(n.In,{icon:"solar:link-linear",className:"w-3 h-3 inline mr-1"}),"Web"]})]});case"jobTitle":return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"text-sm",children:e.jobTitle||"-"}),e.linkedinUrl&&(0,r.jsxs)("a",{href:e.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline",children:[(0,r.jsx)(n.In,{icon:"solar:linkedin-linear",className:"w-3 h-3 inline mr-1"}),"LinkedIn"]})]});case"industry":return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.In,{icon:"solar:buildings-linear",className:"w-4 h-4 text-default-400"}),(0,r.jsx)("span",{className:"text-sm capitalize",children:e.industry||"-"})]});case"country":return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-lg",children:O(e.country)}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm",children:e.country||"-"}),e.city&&(0,r.jsx)("span",{className:"text-xs text-default-400",children:e.city})]})]});case"status":return(0,r.jsx)(c.R,{className:"capitalize",color:C[e.status]||"default",size:"sm",variant:"flat",children:S[e.status]||e.status});case"score":return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat((s=e.score)>=80?"bg-success":s>=60?"bg-warning":s>=40?"bg-secondary":"bg-danger")}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(e.score),"/100"]}),(0,r.jsx)(c.R,{size:"sm",variant:"dot",color:(t=e.score)>=80?"success":t>=60?"warning":t>=40?"secondary":"danger",children:(m=e.score)>=80?"HOT":m>=60?"WARM":m>=40?"COLD":"LOW"})]});case"priority":let p=R(e.priority);return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm",children:p.icon}),(0,r.jsx)(c.R,{size:"sm",color:p.color,variant:"flat",children:p.label})]});case"source":let b=P(e.source);return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.In,{icon:b.icon,className:"w-4 h-4 text-default-400"}),(0,r.jsx)("span",{className:"text-sm",children:b.label})]});case"lastContactedAt":return(0,r.jsx)("div",{className:"flex flex-col",children:e.lastContactedAt?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-sm",children:new Date(e.lastContactedAt).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}),(0,r.jsx)("span",{className:"text-xs text-default-400",children:new Date(e.lastContactedAt).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]}):(0,r.jsx)("span",{className:"text-sm text-default-400",children:"Sin contacto"})});case"createdAt":return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm",children:new Date(e.createdAt).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}),(0,r.jsx)("span",{className:"text-xs text-default-400",children:new Date(e.createdAt).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]});case"actions":return(0,r.jsxs)("div",{className:"relative flex items-center gap-1",children:[(0,r.jsx)(d.I,{content:"Ver detalles",children:(0,r.jsx)(i.T,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>null==o?void 0:o(e),className:"text-default-400 hover:text-primary",children:(0,r.jsx)(n.In,{icon:"solar:eye-linear",className:"w-4 h-4"})})}),(0,r.jsx)(d.I,{content:"Editar lead",children:(0,r.jsx)(i.T,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>null==M?void 0:M(e),className:"text-default-400 hover:text-primary",children:(0,r.jsx)(n.In,{icon:"solar:pen-linear",className:"w-4 h-4"})})}),(l===k.gG.ADMIN||l===k.gG.MANAGER)&&(0,r.jsx)(d.I,{color:"danger",content:"Eliminar lead",children:(0,r.jsx)(i.T,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>null==z?void 0:z(e),className:"text-default-400 hover:text-danger",children:(0,r.jsx)(n.In,{icon:"solar:trash-bin-minimalistic-linear",className:"w-4 h-4"})})})]});default:return(null==(u=e[a])?void 0:u.toString())||"-"}},[l,o,M,z]),eo=(0,t.useCallback)(e=>{e?(q(e),$(1)):q("")},[]),ec=(0,t.useCallback)(()=>{q(""),$(1)},[]),ed=(0,t.useMemo)(()=>(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex justify-between gap-3 items-end",children:[(0,r.jsx)(m.r,{isClearable:!0,className:"w-full sm:max-w-[44%]",placeholder:"Buscar por nombre, empresa, email, pa\xeds...",startContent:(0,r.jsx)(n.In,{icon:"solar:magnifer-linear",className:"w-4 h-4"}),value:F,onClear:ec,onValueChange:eo}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(u.A,{children:[(0,r.jsx)(x.b,{className:"hidden sm:flex",children:(0,r.jsxs)(i.T,{endContent:(0,r.jsx)(n.In,{icon:"solar:alt-arrow-down-linear",className:"w-4 h-4"}),variant:"flat",size:"sm",children:[(0,r.jsx)(n.In,{icon:"solar:filter-linear",className:"w-4 h-4"}),"Estado"]})}),(0,r.jsx)(g.y,{disallowEmptySelection:!0,"aria-label":"Filtro de estado",closeOnSelect:!1,selectedKeys:W,selectionMode:"multiple",onSelectionChange:J,children:Object.entries(S).map(e=>{let[a,s]=e;return(0,r.jsx)(h.Y,{className:"capitalize",children:s},a)})})]}),(0,r.jsxs)(u.A,{children:[(0,r.jsx)(x.b,{className:"hidden sm:flex",children:(0,r.jsxs)(i.T,{endContent:(0,r.jsx)(n.In,{icon:"solar:alt-arrow-down-linear",className:"w-4 h-4"}),variant:"flat",size:"sm",children:[(0,r.jsx)(n.In,{icon:"solar:eye-linear",className:"w-4 h-4"}),"Columnas"]})}),(0,r.jsx)(g.y,{disallowEmptySelection:!0,"aria-label":"Columnas de tabla",closeOnSelect:!1,selectedKeys:B,selectionMode:"multiple",onSelectionChange:V,children:T.map(e=>(0,r.jsx)(h.Y,{className:"capitalize",children:e.name},e.uid))})]}),(0,r.jsx)(d.I,{content:"Actualizar datos",children:(0,r.jsx)(i.T,{isIconOnly:!0,variant:"flat",size:"sm",onPress:G,children:(0,r.jsx)(n.In,{icon:"solar:refresh-linear",className:"w-4 h-4"})})})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-default-400 text-small",children:[(0,r.jsx)(n.In,{icon:"solar:users-group-rounded-linear",className:"w-4 h-4 inline mr-1"}),es.length," de ",a.length," leads"]}),(0,r.jsxs)("label",{className:"flex items-center text-default-400 text-small",children:["Filas por p\xe1gina:",(0,r.jsxs)("select",{className:"bg-transparent outline-none text-default-400 text-small ml-2",value:Y,onChange:e=>K(Number(e.target.value)),children:[(0,r.jsx)("option",{value:"10",children:"10"}),(0,r.jsx)("option",{value:"25",children:"25"}),(0,r.jsx)("option",{value:"50",children:"50"}),(0,r.jsx)("option",{value:"100",children:"100"})]})]})]}),ei.length>0&&(0,r.jsx)(p.Z,{className:"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800",children:(0,r.jsx)(b.U,{className:"py-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.In,{icon:"solar:check-circle-linear",className:"w-5 h-5 text-primary"}),(0,r.jsx)("span",{className:"text-small text-primary font-medium",children:"all"===H?"Todos los leads seleccionados":"".concat(ei.length," leads seleccionados")})]}),(0,r.jsxs)(u.A,{children:[(0,r.jsx)(x.b,{children:(0,r.jsxs)(i.T,{size:"sm",color:"primary",variant:"flat",children:["Acciones seleccionadas",(0,r.jsx)(n.In,{icon:"solar:alt-arrow-down-linear",className:"w-4 h-4"})]})}),(0,r.jsxs)(g.y,{"aria-label":"Acciones masivas",onAction:e=>{null==U||U(e,ei)},children:[(0,r.jsx)(h.Y,{startContent:(0,r.jsx)(n.In,{icon:"solar:phone-linear",className:"w-4 h-4"}),children:"Marcar como contactado"},"mark-contacted"),(0,r.jsx)(h.Y,{startContent:(0,r.jsx)(n.In,{icon:"solar:verified-check-linear",className:"w-4 h-4"}),children:"Marcar como calificado"},"mark-qualified"),(0,r.jsx)(h.Y,{startContent:(0,r.jsx)(n.In,{icon:"solar:flag-linear",className:"w-4 h-4"}),children:"Cambiar prioridad"},"change-priority"),(0,r.jsx)(h.Y,{startContent:(0,r.jsx)(n.In,{icon:"solar:download-linear",className:"w-4 h-4"}),children:"Exportar a CSV"},"export-csv"),(0,r.jsx)(h.Y,{startContent:(0,r.jsx)(n.In,{icon:"solar:copy-linear",className:"w-4 h-4"}),children:"Copiar datos"},"copy-data"),(0,r.jsx)(h.Y,{className:"text-danger",color:"danger",startContent:(0,r.jsx)(n.In,{icon:"solar:trash-bin-minimalistic-linear",className:"w-4 h-4"}),children:"Eliminar seleccionados"},"delete-leads")]})]})]})})})]}),[F,W,B,a.length,es.length,ei,H,Y,eo,ec,G,U]),em=(0,t.useMemo)(()=>(0,r.jsxs)("div",{className:"py-2 px-2 flex justify-between items-center",children:[(0,r.jsx)("span",{className:"w-[30%] text-small text-default-400",children:"all"===H?"Todos los elementos seleccionados":"".concat(H.size," de ").concat(es.length," seleccionados")}),(0,r.jsx)(y.T,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:Q,total:er,onChange:$}),(0,r.jsxs)("div",{className:"hidden sm:flex w-[30%] justify-end gap-2",children:[(0,r.jsx)(i.T,{isDisabled:1===er,size:"sm",variant:"flat",onPress:()=>$(1),children:"Primero"}),(0,r.jsx)(i.T,{isDisabled:1===er,size:"sm",variant:"flat",onPress:()=>$(er),children:"\xdaltimo"})]})]}),[H,es.length,Q,er]);return s?(0,r.jsx)(p.Z,{className:"w-full",children:(0,r.jsx)(b.U,{className:"flex items-center justify-center h-64",children:(0,r.jsx)(A.Ay,{variant:"inline",message:"Cargando leads...",size:"md"})})}):(0,r.jsxs)(j.j,{"aria-label":"Tabla avanzada de leads con gesti\xf3n completa",isHeaderSticky:!0,bottomContent:em,bottomContentPlacement:"outside",classNames:{wrapper:"max-h-[700px]",th:"bg-default-100 text-default-600 text-tiny font-semibold",td:"py-4"},selectedKeys:H,selectionMode:"multiple",sortDescriptor:Z,topContent:ed,topContentPlacement:"outside",onSelectionChange:_,onSortChange:X,children:[(0,r.jsx)(v.X,{columns:ea,children:e=>(0,r.jsx)(N.e,{align:"actions"===e.uid?"center":"start",allowsSorting:e.sortable,children:e.name},e.uid)}),(0,r.jsx)(f.E,{emptyContent:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 py-8",children:[(0,r.jsx)(n.In,{icon:"solar:users-group-rounded-linear",className:"w-12 h-12 text-default-300"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-default-500 font-medium",children:"No se encontraron leads"}),(0,r.jsx)("p",{className:"text-default-400 text-small",children:"Intenta ajustar los filtros de b\xfasqueda"})]})]}),items:el,children:e=>(0,r.jsx)(w.s,{children:a=>(0,r.jsx)(E.w,{children:en(e,a)})},e.id)})]})};var z=s(66440),U=s(14170),G=s(17781),F=s(57208),q=s(44393),H=s(92975),_=s(18593),B=s(74633),V=s(35565),W=s(65529),J=s(72227);let Y=[{id:"basic",name:"Informaci\xf3n B\xe1sica",icon:U.A},{id:"professional",name:"Informaci\xf3n Profesional",icon:G.A},{id:"contact",name:"Contacto y Ubicaci\xf3n",icon:F.A},{id:"lead",name:"Datos del Lead",icon:q.A},{id:"notes",name:"Notas y Seguimiento",icon:H.A}];function K(e){let{isOpen:a,onClose:s,onSubmit:i,initialData:n,mode:o="create"}=e,[c,d]=(0,t.useState)("basic"),[m,u]=(0,t.useState)(!1),[x,g]=(0,t.useState)({}),[h,p]=(0,t.useState)({firstName:(null==n?void 0:n.firstName)||"",lastName:(null==n?void 0:n.lastName)||"",fullName:(null==n?void 0:n.fullName)||"",email:(null==n?void 0:n.email)||"",phone:(null==n?void 0:n.phone)||"",company:(null==n?void 0:n.company)||"",jobTitle:(null==n?void 0:n.jobTitle)||"",website:(null==n?void 0:n.website)||"",linkedinUrl:(null==n?void 0:n.linkedinUrl)||"",companySize:(null==n?void 0:n.companySize)||"",industry:(null==n?void 0:n.industry)||"",location:(null==n?void 0:n.location)||"",country:(null==n?void 0:n.country)||"",city:(null==n?void 0:n.city)||"",state:(null==n?void 0:n.state)||"",timezone:(null==n?void 0:n.timezone)||"",language:(null==n?void 0:n.language)||"",source:(null==n?void 0:n.source)||"manual",status:(null==n?void 0:n.status)||"new",priority:(null==n?void 0:n.priority)||2,score:(null==n?void 0:n.score)||0,notes:(null==n?void 0:n.notes)||"",lastContactedAt:(null==n?void 0:n.lastContactedAt)||"",department:(null==n?void 0:n.department)||"",tags:(null==n?void 0:n.tags)||[],nextFollowUpDate:(null==n?void 0:n.nextFollowUpDate)||""}),b=()=>{let e={};return h.firstName.trim()||(e.firstName="El nombre es requerido"),h.lastName.trim()||(e.lastName="El apellido es requerido"),h.email.trim()?/\S+@\S+\.\S+/.test(h.email)||(e.email="Email inv\xe1lido"):e.email="El email es requerido",g(e),0===Object.keys(e).length},y=async e=>{if(e.preventDefault(),!b())return void d("basic");u(!0);try{let e={firstName:h.firstName,lastName:h.lastName,fullName:h.fullName,email:h.email,phone:h.phone,company:h.company,jobTitle:h.jobTitle,website:h.website,linkedinUrl:h.linkedinUrl,companySize:h.companySize,industry:h.industry,location:h.location,country:h.country,city:h.city,state:h.state,timezone:h.timezone,language:h.language,source:h.source,status:h.status,priority:h.priority,score:h.score,notes:h.notes,lastContactedAt:h.lastContactedAt,department:h.department,tags:h.tags,nextFollowUpDate:h.nextFollowUpDate};await i(e)}catch(e){console.warn("Error submitting form:",e)}finally{u(!1)}},j=(e,a)=>{p(s=>({...s,[e]:a})),x[e]&&g(a=>({...a,[e]:""}))},v=e=>{e&&!h.tags.includes(e)&&j("tags",[...h.tags,e])},N=e=>{j("tags",h.tags.filter(a=>a!==e))};return(0,r.jsx)(z.A,{isOpen:a,onClose:s,title:"edit"===o?"Editar Lead":"Nuevo Lead",size:"xl",children:m?(0,r.jsx)("div",{className:"p-8",children:(0,r.jsx)(A.Ay,{message:"edit"===o?"Actualizando lead...":"Creando nuevo lead...",size:"md"})}):(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:(0,r.jsxs)("form",{onSubmit:y,children:[(0,r.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-8",children:(0,r.jsx)("nav",{className:"flex space-x-8",children:Y.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>d(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(c===e.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,r.jsx)(e.icon,{className:"w-5 h-5 mr-2"}),e.name]},e.id))})}),(0,r.jsx)("div",{className:"mb-8",children:(()=>{switch(c){case"basic":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(U.A,{className:"h-4 w-4 inline mr-2"}),"Nombre *"]}),(0,r.jsx)("input",{type:"text",value:h.firstName,onChange:e=>j("firstName",e.target.value),className:"w-full px-4 py-3 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors ".concat(x.firstName?"border-red-300 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500"),placeholder:"Mar\xeda"}),x.firstName&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Apellido *"}),(0,r.jsx)("input",{type:"text",value:h.lastName,onChange:e=>j("lastName",e.target.value),className:"w-full px-4 py-3 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors ".concat(x.lastName?"border-red-300 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500"),placeholder:"Gonz\xe1lez"}),x.lastName&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.lastName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre completo"}),(0,r.jsx)("input",{type:"text",value:h.fullName,onChange:e=>j("fullName",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Mar\xeda Gonz\xe1lez"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(_.A,{className:"h-4 w-4 inline mr-2"}),"Email *"]}),(0,r.jsx)("input",{type:"email",value:h.email,onChange:e=>j("email",e.target.value),className:"w-full px-4 py-3 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors ".concat(x.email?"border-red-300 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500"),placeholder:"maria@empresa.com"}),x.email&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(B.A,{className:"h-4 w-4 inline mr-2"}),"Tel\xe9fono"]}),(0,r.jsx)("input",{type:"tel",value:h.phone,onChange:e=>j("phone",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"+54 11 1234-5678"})]})]})]});case"professional":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(V.A,{className:"h-4 w-4 inline mr-2"}),"Empresa"]}),(0,r.jsx)("input",{type:"text",value:h.company,onChange:e=>j("company",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Tech Solutions Inc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(G.A,{className:"h-4 w-4 inline mr-2"}),"Cargo"]}),(0,r.jsx)("input",{type:"text",value:h.jobTitle,onChange:e=>j("jobTitle",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Directora de Marketing"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Departamento"}),(0,r.jsxs)("select",{value:h.department,onChange:e=>j("department",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar departamento"}),(0,r.jsx)("option",{value:"marketing",children:"Marketing"}),(0,r.jsx)("option",{value:"sales",children:"Ventas"}),(0,r.jsx)("option",{value:"it",children:"IT/Tecnolog\xeda"}),(0,r.jsx)("option",{value:"hr",children:"Recursos Humanos"}),(0,r.jsx)("option",{value:"finance",children:"Finanzas"}),(0,r.jsx)("option",{value:"operations",children:"Operaciones"}),(0,r.jsx)("option",{value:"executive",children:"Ejecutivo"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Industria"}),(0,r.jsxs)("select",{value:h.industry,onChange:e=>j("industry",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar industria"}),(0,r.jsx)("option",{value:"technology",children:"Tecnolog\xeda"}),(0,r.jsx)("option",{value:"finance",children:"Finanzas"}),(0,r.jsx)("option",{value:"healthcare",children:"Salud"}),(0,r.jsx)("option",{value:"education",children:"Educaci\xf3n"}),(0,r.jsx)("option",{value:"retail",children:"Retail"}),(0,r.jsx)("option",{value:"manufacturing",children:"Manufactura"}),(0,r.jsx)("option",{value:"consulting",children:"Consultor\xeda"}),(0,r.jsx)("option",{value:"real-estate",children:"Inmobiliaria"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tama\xf1o de empresa"}),(0,r.jsxs)("select",{value:h.companySize,onChange:e=>j("companySize",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar tama\xf1o"}),(0,r.jsx)("option",{value:"1-10",children:"1-10 empleados"}),(0,r.jsx)("option",{value:"11-50",children:"11-50 empleados"}),(0,r.jsx)("option",{value:"51-200",children:"51-200 empleados"}),(0,r.jsx)("option",{value:"201-500",children:"201-500 empleados"}),(0,r.jsx)("option",{value:"501-1000",children:"501-1000 empleados"}),(0,r.jsx)("option",{value:"1000+",children:"1000+ empleados"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(W.A,{className:"h-4 w-4 inline mr-2"}),"Sitio web"]}),(0,r.jsx)("input",{type:"url",value:h.website,onChange:e=>j("website",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"https://empresa.com"})]})]})]});case"contact":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"LinkedIn URL"}),(0,r.jsx)("input",{type:"url",value:h.linkedinUrl,onChange:e=>j("linkedinUrl",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"https://linkedin.com/in/maria-gonzalez"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(F.A,{className:"h-4 w-4 inline mr-2"}),"Ubicaci\xf3n general"]}),(0,r.jsx)("input",{type:"text",value:h.location,onChange:e=>j("location",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Buenos Aires, Argentina"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ciudad"}),(0,r.jsx)("input",{type:"text",value:h.city,onChange:e=>j("city",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Buenos Aires"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Estado/Provincia"}),(0,r.jsx)("input",{type:"text",value:h.state,onChange:e=>j("state",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"CABA"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pa\xeds"}),(0,r.jsxs)("select",{value:h.country,onChange:e=>j("country",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar pa\xeds"}),(0,r.jsx)("option",{value:"AR",children:"Argentina"}),(0,r.jsx)("option",{value:"US",children:"Estados Unidos"}),(0,r.jsx)("option",{value:"ES",children:"Espa\xf1a"}),(0,r.jsx)("option",{value:"MX",children:"M\xe9xico"}),(0,r.jsx)("option",{value:"CO",children:"Colombia"}),(0,r.jsx)("option",{value:"CL",children:"Chile"}),(0,r.jsx)("option",{value:"PE",children:"Per\xfa"}),(0,r.jsx)("option",{value:"BR",children:"Brasil"}),(0,r.jsx)("option",{value:"UY",children:"Uruguay"}),(0,r.jsx)("option",{value:"PY",children:"Paraguay"}),(0,r.jsx)("option",{value:"BO",children:"Bolivia"}),(0,r.jsx)("option",{value:"EC",children:"Ecuador"}),(0,r.jsx)("option",{value:"VE",children:"Venezuela"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zona horaria"}),(0,r.jsxs)("select",{value:h.timezone,onChange:e=>j("timezone",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar zona horaria"}),(0,r.jsx)("option",{value:"America/Argentina/Buenos_Aires",children:"GMT-3 (Buenos Aires)"}),(0,r.jsx)("option",{value:"America/New_York",children:"GMT-5 (New York)"}),(0,r.jsx)("option",{value:"Europe/Madrid",children:"GMT+1 (Madrid)"}),(0,r.jsx)("option",{value:"America/Mexico_City",children:"GMT-6 (M\xe9xico)"}),(0,r.jsx)("option",{value:"America/Bogota",children:"GMT-5 (Bogot\xe1)"}),(0,r.jsx)("option",{value:"America/Santiago",children:"GMT-4 (Santiago)"}),(0,r.jsx)("option",{value:"America/Lima",children:"GMT-5 (Lima)"}),(0,r.jsx)("option",{value:"America/Sao_Paulo",children:"GMT-3 (S\xe3o Paulo)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Idioma"}),(0,r.jsxs)("select",{value:h.language,onChange:e=>j("language",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar idioma"}),(0,r.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,r.jsx)("option",{value:"en",children:"Ingl\xe9s"}),(0,r.jsx)("option",{value:"pt",children:"Portugu\xe9s"}),(0,r.jsx)("option",{value:"fr",children:"Franc\xe9s"}),(0,r.jsx)("option",{value:"it",children:"Italiano"}),(0,r.jsx)("option",{value:"de",children:"Alem\xe1n"})]})]})]})]});case"lead":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fuente del lead"}),(0,r.jsxs)("select",{value:h.source,onChange:e=>j("source",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"manual",children:"Manual"}),(0,r.jsx)("option",{value:"website",children:"Sitio web"}),(0,r.jsx)("option",{value:"linkedin",children:"LinkedIn"}),(0,r.jsx)("option",{value:"referral",children:"Referido"}),(0,r.jsx)("option",{value:"cold-email",children:"Email fr\xedo"}),(0,r.jsx)("option",{value:"event",children:"Evento"}),(0,r.jsx)("option",{value:"import",children:"Importaci\xf3n"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Estado del lead"}),(0,r.jsxs)("select",{value:h.status,onChange:e=>j("status",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"new",children:"Nuevo"}),(0,r.jsx)("option",{value:"contacted",children:"Contactado"}),(0,r.jsx)("option",{value:"qualified",children:"Calificado"}),(0,r.jsx)("option",{value:"proposal",children:"Propuesta"}),(0,r.jsx)("option",{value:"negotiation",children:"Negociaci\xf3n"}),(0,r.jsx)("option",{value:"closed-won",children:"Cerrado ganado"}),(0,r.jsx)("option",{value:"closed-lost",children:"Cerrado perdido"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Prioridad"}),(0,r.jsxs)("select",{value:h.priority,onChange:e=>j("priority",parseInt(e.target.value)),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"1",children:"\uD83D\uDD34 Alta"}),(0,r.jsx)("option",{value:"2",children:"\uD83D\uDFE1 Media"}),(0,r.jsx)("option",{value:"3",children:"\uD83D\uDFE2 Baja"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Score (0-100)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:h.score,onChange:e=>j("score",parseInt(e.target.value)),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400 mt-1",children:[h.score,"/100"]})]})]})]});case"notes":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(H.A,{className:"h-4 w-4 inline mr-2"}),"Notas"]}),(0,r.jsx)("textarea",{value:h.notes,onChange:e=>j("notes",e.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",placeholder:"Informaci\xf3n adicional sobre el lead, conversaciones previas, intereses espec\xedficos..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 inline mr-2"}),"\xdaltimo contacto"]}),(0,r.jsx)("input",{type:"date",value:h.lastContactedAt,onChange:e=>j("lastContactedAt",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 inline mr-2"}),"Pr\xf3ximo seguimiento"]}),(0,r.jsx)("input",{type:"date",value:h.nextFollowUpDate,onChange:e=>j("nextFollowUpDate",e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,r.jsx)(q.A,{className:"h-4 w-4 inline mr-2"}),"Tags"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:h.tags.map((e,a)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>N(e),className:"ml-2 text-blue-600 hover:text-blue-800",children:"\xd7"})]},a))}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"Agregar tag...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 transition-colors",onKeyPress:e=>{if("Enter"===e.key){e.preventDefault();let a=e.target;v(a.value.trim()),a.value=""}}}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",onClick:e=>{let a=e.target.previousElementSibling;v(a.value.trim()),a.value=""},children:"Agregar"})]})]})]});default:return null}})()}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-100 dark:border-gray-700",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"edit"===o?"Actualizar Lead":"Crear Lead"})]})]})})})}var Z=s(60760),X=s(30192),Q=s(82771),$=s(74500),ee=s(86474),ea=s(5500),es=s(29337),er=s(61316),et=s(78260);function el(e){var a,s,i,n,o,c;let{isOpen:d,onClose:m,leadId:u,onEdit:x}=e,[g,h]=(0,t.useState)(null),[p,b]=(0,t.useState)(!1),[y,j]=(0,t.useState)("overview"),[v,N]=(0,t.useState)([]),[f,w]=(0,t.useState)(null);(0,t.useEffect)(()=>{d&&u&&E()},[d,u]);let E=async()=>{if(u){b(!0);try{let[e,a]=await Promise.all([fetch("/api/prospects/".concat(u)),fetch("/api/hubspot?leadId=".concat(u))]),s=await e.json(),r=await a.json();if(s.success){let e={lead:s.data,hubspot:r.hubspot||null,conversations:r.conversations||[],activities:r.activities||[],scoring:r.scoring||null,aiAnalysis:r.aiAnalysis||null,timeline:r.timeline||[]};h(e),k(e)}}catch(e){console.warn("Error fetching enriched data:",e),et.oR.error("Error al cargar datos del lead")}finally{b(!1)}}},k=e=>{let a=e.lead.score,s=[];a>=80?(s.push({type:"task",priority:"high",title:"Llamada de seguimiento urgente",description:"Este lead tiene alta probabilidad de conversi\xf3n. Contactar inmediatamente.",suggestedDate:new Date(Date.now()+864e5).toISOString().split("T")[0],suggestedTime:"10:00",icon:B.A}),s.push({type:"message",priority:"high",title:"Email personalizado de seguimiento",description:"Mensaje directo y personalizado para cerrar la venta.",content:"Hola ".concat(e.lead.name||e.lead.fullName,",\n\nHe estado revisando el perfil de ").concat(e.lead.company," y creo que tenemos una oportunidad perfecta para ayudarles a optimizar sus procesos.\n\nBas\xe1ndome en su industria y tama\xf1o de empresa, he preparado una propuesta espec\xedfica que podr\xeda generar un ROI del 300% en los primeros 6 meses.\n\n\xbfTendr\xeda 15 minutos ma\xf1ana para una breve llamada? Puedo mostrarle exactamente c\xf3mo otras empresas similares han logrado estos resultados.\n\nSaludos,\n[Tu nombre]"),icon:_.A})):a>=60?(s.push({type:"task",priority:"medium",title:"Reuni\xf3n de descubrimiento",description:"Programar reuni\xf3n para entender necesidades espec\xedficas.",suggestedDate:new Date(Date.now()+2592e5).toISOString().split("T")[0],suggestedTime:"14:00",icon:J.A}),s.push({type:"message",priority:"medium",title:"Compartir caso de \xe9xito relevante",description:"Enviar caso de estudio de empresa similar.",content:"Hola ".concat(e.lead.name||e.lead.fullName,",\n\nEspero que est\xe9 teniendo una excelente semana en ").concat(e.lead.company,".\n\nQuer\xeda compartir con usted un caso de \xe9xito reciente que creo que le resultar\xe1 muy interesante. Trabajamos con una empresa de su sector que logr\xf3:\n\n• Reducir costos operativos en un 40%\n• Aumentar la eficiencia del equipo en un 60%\n• Mejorar la satisfacci\xf3n del cliente al 95%\n\nMe gustar\xeda mostrarle c\xf3mo lograron estos resultados y c\xf3mo podr\xedamos adaptar esta estrategia para ").concat(e.lead.company,".\n\n\xbfLe interesar\xeda una breve conversaci\xf3n esta semana?\n\nSaludos,\n[Tu nombre]"),icon:X.A})):(s.push({type:"task",priority:"low",title:"Seguimiento mensual",description:"Mantener contacto regular con contenido de valor.",suggestedDate:new Date(Date.now()+2592e6).toISOString().split("T")[0],suggestedTime:"09:00",icon:Q.A}),s.push({type:"message",priority:"low",title:"Newsletter con contenido educativo",description:"Compartir recursos valiosos sin presi\xf3n comercial.",content:"Hola ".concat(e.lead.name||e.lead.fullName,",\n\nEspero que se encuentre muy bien.\n\nHe estado preparando algunos recursos que creo que podr\xedan ser de gran valor para profesionales como usted en ").concat(e.lead.company,'.\n\nHe creado una gu\xeda completa sobre "Las 10 mejores pr\xe1cticas para optimizar procesos en empresas de su sector" que incluye:\n\n• Estrategias probadas por l\xedderes de la industria\n• Plantillas descargables\n• Casos de estudio reales\n• Checklist de implementaci\xf3n\n\n\xbfLe gustar\xeda que se la env\xede? Es completamente gratuita y sin compromiso.\n\nSaludos,\n[Tu nombre]'),icon:_.A})),N(s)},C=async(e,a)=>{w("".concat(e.type,"-").concat(a));try{"task"===e.type?(await fetch("/api/tasks/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:null==g?void 0:g.lead.id,type:e.title.toLowerCase().includes("llamada")?"call":e.title.toLowerCase().includes("reuni\xf3n")?"meeting":"follow-up",date:e.suggestedDate,time:e.suggestedTime,notes:e.description,scheduledAt:"".concat(e.suggestedDate,"T").concat(e.suggestedTime)})})).ok&&et.oR.success("Tarea programada exitosamente"):(navigator.clipboard.writeText(e.content||""),et.oR.success("Mensaje copiado al portapapeles"))}catch(e){et.oR.error("Error al procesar recomendaci\xf3n")}finally{w(null)}},S=e=>{switch(e){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return d?(0,r.jsx)(Z.N,{children:(0,r.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:m,children:(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:p?(0,r.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,r.jsx)(A.Ay,{variant:"inline",message:"Cargando datos del lead...",size:"md"})}):g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-100 p-6",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xl font-semibold text-gray-700",children:(g.lead.name||g.lead.fullName||"NN").split(" ").map(e=>e[0]).join("").toUpperCase()})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-1",children:g.lead.name||g.lead.fullName||"Sin nombre"}),(0,r.jsxs)("p",{className:"text-gray-600 mb-3",children:[g.lead.jobTitle," en ",g.lead.company]}),(0,r.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat((o=g.lead.score)>=80?"text-red-600 bg-red-50":o>=60?"text-orange-600 bg-orange-50":o>=40?"text-blue-600 bg-blue-50":"text-gray-600 bg-gray-50"),children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-current mr-2"}),(c=g.lead.score)>=80?"HOT":c>=60?"WARM":c>=40?"QUALIFIED":"NURTURE"," (",g.lead.score,")"]})]})]}),(0,r.jsx)("button",{onClick:m,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,r.jsx)($.A,{className:"w-6 h-6 text-gray-500"})})]})}),(0,r.jsx)("div",{className:"bg-white border-b border-gray-100",children:(0,r.jsx)("nav",{className:"flex",children:[{id:"overview",label:"Informaci\xf3n",icon:U.A},{id:"recommendations",label:"Recomendaciones IA",icon:ee.A},{id:"insights",label:"Insights",icon:ea.A}].map(e=>(0,r.jsxs)("button",{onClick:()=>j(e.id),className:"flex items-center space-x-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(y===e.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,r.jsx)(e.icon,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:e.label})]},e.id))})}),(0,r.jsxs)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:["overview"===y&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contacto"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)(_.A,{className:"w-5 h-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:g.lead.email})]})]}),g.lead.phone&&(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)(B.A,{className:"w-5 h-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Tel\xe9fono"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:g.lead.phone})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)(V.A,{className:"w-5 h-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Empresa"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:g.lead.company})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"M\xe9tricas"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==(a=g.activities)?void 0:a.length)||0}),(0,r.jsx)("div",{className:"text-sm text-blue-600",children:"Actividades"})]}),(0,r.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null==(s=g.conversations)?void 0:s.length)||0}),(0,r.jsx)("div",{className:"text-sm text-green-600",children:"Conversaciones"})]}),(0,r.jsxs)("div",{className:"p-4 bg-purple-50 rounded-lg text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[(null==(i=g.aiAnalysis)?void 0:i.conversionProbability)||0,"%"]}),(0,r.jsx)("div",{className:"text-sm text-purple-600",children:"Conversi\xf3n"})]}),(0,r.jsxs)("div",{className:"p-4 bg-orange-50 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(null==(n=g.aiAnalysis)?void 0:n.buyingSignals)||0}),(0,r.jsx)("div",{className:"text-sm text-orange-600",children:"Se\xf1ales"})]})]})]})]}),"recommendations"===y&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)(ee.A,{className:"w-12 h-12 text-blue-600 mx-auto mb-3"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Recomendaciones Inteligentes"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Basadas en el an\xe1lisis de IA y scoring del lead"})]}),(0,r.jsx)("div",{className:"space-y-4",children:v.map((e,a)=>(0,r.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,r.jsx)(e.icon,{className:"w-6 h-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:e.title}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(S(e.priority)),children:e.priority.toUpperCase()})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-3",children:e.description}),e.suggestedDate&&(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[(0,r.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,r.jsx)(J.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:new Date(e.suggestedDate).toLocaleDateString()})]}),e.suggestedTime&&(0,r.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,r.jsx)(Q.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:e.suggestedTime})]})]}),e.content&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-sm text-gray-700 font-mono",children:[e.content.substring(0,100),"..."]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>C(e,a),disabled:f==="".concat(e.type,"-").concat(a),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:[f==="".concat(e.type,"-").concat(a)?(0,r.jsx)(A.Ay,{variant:"minimal",size:"xs",color:"primary"}):(0,r.jsx)(es.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Aceptar"})]}),(0,r.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors",children:(0,r.jsx)(er.A,{className:"w-4 h-4"})})]})]})},a))})]}),"insights"===y&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"An\xe1lisis de IA"}),g.aiAnalysis?(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[Math.round(100*g.aiAnalysis.sentimentScore),"%"]}),(0,r.jsx)("div",{className:"text-blue-700 font-medium",children:"Sentiment Score"}),(0,r.jsx)("div",{className:"text-sm text-blue-600 mt-1",children:g.aiAnalysis.sentimentScore>.5?"Positivo":g.aiAnalysis.sentimentScore>0?"Neutral":"Negativo"})]}),(0,r.jsxs)("div",{className:"text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-2",children:g.aiAnalysis.buyingSignals||0}),(0,r.jsx)("div",{className:"text-green-700 font-medium",children:"Se\xf1ales de Compra"}),(0,r.jsx)("div",{className:"text-sm text-green-600 mt-1",children:"Detectadas"})]}),(0,r.jsxs)("div",{className:"text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:[g.aiAnalysis.conversionProbability||0,"%"]}),(0,r.jsx)("div",{className:"text-purple-700 font-medium",children:"Probabilidad"}),(0,r.jsx)("div",{className:"text-sm text-purple-600 mt-1",children:"de Conversi\xf3n"})]})]}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(ea.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"No hay datos de an\xe1lisis disponibles"})]})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-red-500 mb-4",children:(0,r.jsx)($.A,{className:"w-16 h-16 mx-auto"})}),(0,r.jsx)("p",{className:"text-gray-600",children:"No se pudieron cargar los datos del lead"})]})})})}):null}function ei(){let{user:e}=(0,o.As)(),[a,s]=(0,t.useState)([]),[c,d]=(0,t.useState)(!0),[m,u]=(0,t.useState)(null),[x,g]=(0,t.useState)(!1),[h,p]=(0,t.useState)(!1),[b,y]=(0,t.useState)(!1),[j,v]=(0,t.useState)(null),[N,f]=(0,t.useState)(null),[w,E]=(0,t.useState)(!1),[k,A]=(0,t.useState)(null),C=async()=>{try{d(!0),u(null);let e=await fetch("/api/prospects"),a=await e.json();if(a.success)s(a.data||[]);else throw Error(a.error||"Error al cargar leads")}catch(e){console.warn("Error fetching leads:",e),u(e.message),et.oR.error("Error al cargar leads")}finally{d(!1)}};(0,t.useEffect)(()=>{C()},[]);let S=async e=>{try{let a=await fetch("/api/prospects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await a.json();if(s.success)g(!1),await C(),et.oR.success("Lead creado exitosamente");else throw Error(s.error||"Error al crear lead")}catch(e){console.warn("Error creating lead:",e),et.oR.error(e.message)}},T=async e=>{if(j)try{let a=await fetch("/api/prospects/".concat(j.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await a.json();if(s.success)p(!1),v(null),await C(),et.oR.success("Lead actualizado exitosamente");else throw Error(s.error||"Error al actualizar lead")}catch(e){console.warn("Error updating lead:",e),et.oR.error(e.message)}},I=async()=>{if(k)try{let e=await fetch("/api/prospects/".concat(k),{method:"DELETE"}),a=await e.json();if(a.success)await C(),et.oR.success("Lead eliminado exitosamente");else throw Error(a.error||"Error al eliminar lead")}catch(e){console.warn("Error deleting lead:",e),et.oR.error(e.message)}finally{E(!1),A(null)}},L=async(e,a)=>{let s=a.map(e=>e.id);try{let r="POST",t={action:e,leadIds:s};switch(e){case"mark-contacted":t.status="CONTACTED";break;case"mark-qualified":t.status="VALIDATED";break;case"change-priority":t.priority=3;break;case"export-csv":let l=D(a);O(l,"leads-export.csv"),et.oR.success("".concat(a.length," leads exportados"));return;case"copy-data":let i=a.map(e=>"".concat(e.fullName||e.firstName+" "+e.lastName," - ").concat(e.email," - ").concat(e.company)).join("\n");await navigator.clipboard.writeText(i),et.oR.success("Datos copiados al portapapeles");return;case"delete-leads":if(!confirm("\xbfEst\xe1s seguro de eliminar ".concat(a.length," leads?")))return;r="DELETE"}let n=await fetch("/api/prospects/bulk",{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await n.json();if(o.success)await C(),et.oR.success('Acci\xf3n "'.concat(e,'" aplicada a ').concat(a.length," leads"));else throw Error(o.error||"Error en acci\xf3n masiva")}catch(e){console.warn("Error in bulk action:",e),et.oR.error(e.message)}},D=e=>[["Nombre","Email","Empresa","Cargo","Tel\xe9fono","Pa\xeds","Estado","Score","Prioridad","Fuente","Creado"],...e.map(e=>[e.fullName||"".concat(e.firstName||""," ").concat(e.lastName||"").trim(),e.email,e.company||"",e.jobTitle||"",e.phone||"",e.country||"",e.status,e.score,e.priority,e.source,new Date(e.createdAt).toLocaleDateString("es-ES")])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),O=(e,a)=>{let s=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){let e=URL.createObjectURL(s);r.setAttribute("href",e),r.setAttribute("download",a),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Gesti\xf3n de Leads"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Administra y rastrea tus leads de prospecci\xf3n con an\xe1lisis avanzado de IA"})]}),(0,r.jsx)(i.T,{color:"primary",startContent:(0,r.jsx)(n.In,{icon:"solar:add-circle-linear",className:"w-5 h-5"}),onPress:()=>g(!0),children:"Nuevo Lead"})]}),m&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(n.In,{icon:"solar:danger-circle-linear",className:"w-5 h-5 text-red-400"}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,r.jsx)("p",{className:"text-sm text-red-700 mt-1",children:m}),(0,r.jsx)(i.T,{size:"sm",color:"danger",variant:"light",className:"mt-2",onPress:C,children:"Reintentar"})]})]})}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:c?"Cargando leads...":"".concat(a.length," leads encontrados")}),(0,r.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:(0,r.jsx)(M,{leads:a,loading:c,userRole:null==e?void 0:e.role,onLeadSelect:e=>{f(e.id),y(!0)},onLeadEdit:e=>{v(e),p(!0)},onLeadDelete:e=>{A(e.id),E(!0)},onBulkAction:L,onRefresh:C})}),x&&(0,r.jsx)(K,{isOpen:x,onClose:()=>g(!1),onSubmit:S,mode:"create"}),h&&j&&(0,r.jsx)(K,{isOpen:h,onClose:()=>{p(!1),v(null)},onSubmit:T,initialData:j,mode:"edit"}),b&&N&&(0,r.jsx)(el,{isOpen:b,onClose:()=>{y(!1),f(null)},leadId:N}),w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(n.In,{icon:"solar:danger-circle-linear",className:"w-6 h-6 text-red-500 mr-3"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Confirmar Eliminaci\xf3n"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"\xbfEst\xe1s seguro de que quieres eliminar este lead? Esta acci\xf3n no se puede deshacer."}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)(i.T,{variant:"light",onPress:()=>E(!1),children:"Cancelar"}),(0,r.jsx)(i.T,{color:"danger",onPress:I,children:"Eliminar"})]})]})})]})}},40283:(e,a,s)=>{"use strict";s.d(a,{As:()=>c,OJ:()=>o});var r=s(95155),t=s(12115),l=s(45493);let i=(0,t.createContext)(void 0);function n(e){let{children:a}=e,{data:s,status:n}=(0,l.wV)(),[o,c]=(0,t.useState)(!1),[d,m]=(0,t.useState)(null),u=(null==s?void 0:s.user)?{id:s.user.id,name:s.user.name,email:s.user.email,image:s.user.image||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(s.user.name||s.user.email||""),"&background=3b82f6&color=ffffff"),role:s.user.role||"user",lastLogin:s.user.lastLogin?new Date(s.user.lastLogin):void 0}:null,x="loading"===n,g=async(e,a)=>{try{let s=await fetch("/api/auth/check-2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),r=!1;s.ok&&(r=(await s.json()).has2FA);let t=await (0,l.Jv)("credentials",{email:e,password:a,redirect:!1});if(null==t?void 0:t.error){if(r&&"CredentialsSignin"===t.error)return c(!0),m(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!1,error:"CredentialsSignin"===t.error?"Credenciales inv\xe1lidas":t.error}}if(r)return c(!0),m(e),{success:!1,requires2FA:!0,error:"Se requiere verificaci\xf3n 2FA"};return{success:!0}}catch(e){return{success:!1,error:"Error al iniciar sesi\xf3n"}}},h=async(e,a)=>{try{let s=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,token:a})});if(!s.ok){let e=await s.json();return{success:!1,error:e.message||"C\xf3digo 2FA inv\xe1lido"}}let r=await (0,l.Jv)("credentials",{email:e,token:a,redirect:!1});if(null==r?void 0:r.error)return{success:!1,error:"Error completando autenticaci\xf3n"};return c(!1),m(null),{success:!0}}catch(e){return{success:!1,error:"Error verificando 2FA"}}},p=async(e,a,s)=>{try{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:a,password:s})});if(!r.ok){let e=await r.json();return{success:!1,error:e.message||"Error al crear la cuenta"}}return await g(a,s)}catch(e){return{success:!1,error:"Error al crear la cuenta"}}},b=async e=>{try{let a=await (0,l.Jv)(e,{redirect:!1});if(null==a?void 0:a.error)return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)};return{success:!0}}catch(a){return{success:!1,error:"Error al iniciar sesi\xf3n con ".concat(e)}}},y=async()=>{c(!1),m(null),await (0,l.CI)({redirect:!1})},j=async e=>{try{if(!(await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)return{success:!1,error:"Error al enviar email de recuperaci\xf3n"};return{success:!0}}catch(e){return{success:!1,error:"Error al procesar solicitud de recuperaci\xf3n"}}};return(0,r.jsx)(i.Provider,{value:{user:u,loading:x,isLoading:x,requires2FA:o,pending2FAEmail:d,login:g,verify2FA:h,register:p,logout:y,socialLogin:b,resetPassword:j,session:s},children:a})}function o(e){let{children:a}=e;return(0,r.jsx)(l.CP,{children:(0,r.jsx)(n,{children:a})})}function c(){let e=(0,t.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66440:(e,a,s)=>{"use strict";s.d(a,{A:()=>n});var r=s(95155),t=s(60760),l=s(36545),i=s(74500);function n(e){let{isOpen:a,onClose:s,title:n,children:o,size:c="md",showCloseButton:d=!0}=e;return(0,r.jsx)(t.N,{children:a&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,r.jsxs)(l.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"relative w-full ".concat(sizeClasses[c]," bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-100 dark:border-gray-700"),onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n}),d&&(0,r.jsx)("button",{onClick:s,className:"p-1 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,r.jsx)(i.A,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"px-6 py-4",children:o})]})})]})})}},74217:(e,a,s)=>{"use strict";s.d(a,{Ix:()=>i,W6:()=>o,XN:()=>r,e1:()=>l,gG:()=>t,wP:()=>n});var r=function(e){return e.NEW="NEW",e.ENRICHED="ENRICHED",e.VALIDATED="VALIDATED",e.PRIORITIZED="PRIORITIZED",e.CONTACTED="CONTACTED",e.CONVERTED="CONVERTED",e.LOST="LOST",e}({}),t=function(e){return e.ADMIN="ADMIN",e.MANAGER="MANAGER",e.USER="USER",e.VIEWER="VIEWER",e}({}),l=function(e){return e.PENDING="PENDING",e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED",e.APPROVED="APPROVED",e.REJECTED="REJECTED",e}({}),i=function(e){return e.PROSPECTING="PROSPECTING",e.EMAIL="EMAIL",e.CALL="CALL",e.MEETING="MEETING",e.FOLLOW_UP="FOLLOW_UP",e.RESEARCH="RESEARCH",e.PROPOSAL="PROPOSAL",e.NEGOTIATION="NEGOTIATION",e.CLOSING="CLOSING",e.CUSTOM="CUSTOM",e}({}),n=function(e){return e.MANUAL="MANUAL",e.AUTOMATED="AUTOMATED",e.TEMPLATE="TEMPLATE",e.AI_GENERATED="AI_GENERATED",e.EMAIL="EMAIL",e.CALL="CALL",e.MEETING="MEETING",e.LINKEDIN_MESSAGE="LINKEDIN_MESSAGE",e.WHATSAPP="WHATSAPP",e.PROPOSAL="PROPOSAL",e.DEMO="DEMO",e.FOLLOW_UP="FOLLOW_UP",e.REMINDER="REMINDER",e.NOTE="NOTE",e.RESEARCH="RESEARCH",e}({}),o=function(e){return e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.URGENT="URGENT",e.CRITICAL="CRITICAL",e}({})},97460:(e,a,s)=>{Promise.resolve().then(s.bind(s,22810))}},e=>{var a=a=>e(e.s=a);e.O(0,[545,71,493,907,156,274,607,82,968,441,684,358],()=>a(97460)),_N_E=e.O()}]);