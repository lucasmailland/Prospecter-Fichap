(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{13741:(e,a,s)=>{"use strict";s.d(a,{$:()=>t});var r=s(95155);s(12115);let t=e=>{let{variant:a="primary",size:s="md",children:t,className:l="",loading:n=!1,disabled:i,...c}=e;return(0,r.jsxs)("button",{className:"\n        ".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2","\n        ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500"}[a],"\n        ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[s],"\n        ").concat(i||n?"opacity-50 cursor-not-allowed":"","\n        ").concat(l,"\n      "),disabled:i||n,...c,children:[n&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t]})}},17703:(e,a,s)=>{"use strict";s.d(a,{Wu:()=>n,Zp:()=>t,aR:()=>l});var r=s(95155);s(12115);let t=e=>{let{children:a,className:s="",...t}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm ".concat(s),...t,children:a})},l=e=>{let{children:a,className:s="",...t}=e;return(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 ".concat(s),...t,children:a})},n=e=>{let{children:a,className:s="",...t}=e;return(0,r.jsx)("div",{className:"px-6 py-4 ".concat(s),...t,children:a})};t.Header=l,t.Content=n,t.Footer=e=>{let{children:a,className:s="",...t}=e;return(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 ".concat(s),...t,children:a})}},60681:(e,a,s)=>{Promise.resolve().then(s.bind(s,84145))},66440:(e,a,s)=>{"use strict";s.d(a,{A:()=>i});var r=s(95155),t=s(60760),l=s(36545),n=s(74500);function i(e){let{isOpen:a,onClose:s,title:i,children:c,size:o="md",showCloseButton:d=!0}=e;return(0,r.jsx)(t.N,{children:a&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,r.jsxs)(l.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"relative w-full ".concat(sizeClasses[o]," bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-100 dark:border-gray-700"),onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i}),d&&(0,r.jsx)("button",{onClick:s,className:"p-1 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,r.jsx)(n.A,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"px-6 py-4",children:c})]})})]})})}},84145:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>P});var r=s(95155),t=s(12115),l=s(19776),n=s(85812),i=s(17703),c=s(93915),o=s(13741),d=s(66440),m=s(39968);let p=[{value:"EMAIL",label:"Email"},{value:"LINKEDIN",label:"LinkedIn"},{value:"WHATSAPP",label:"WhatsApp"},{value:"ANALYSIS",label:"An\xe1lisis"},{value:"FOLLOW_UP",label:"Seguimiento"},{value:"PROPOSAL",label:"Propuesta"},{value:"OBJECTION_HANDLING",label:"Manejo de Objeciones"},{value:"RESEARCH",label:"Investigaci\xf3n"},{value:"CUSTOM",label:"Personalizado"}];function x(){let[e,a]=(0,t.useState)([]),[s,l]=(0,t.useState)([]),[n,d]=(0,t.useState)(""),[x,g]=(0,t.useState)(""),[h,y]=(0,t.useState)(!0),[b,j]=(0,t.useState)(null),[f,v]=(0,t.useState)(!1),[N,w]=(0,t.useState)(null);(0,t.useEffect)(()=>{S()},[]),(0,t.useEffect)(()=>{C()},[e,n,x]);let S=async()=>{y(!0);try{let e=await fetch("/api/ai/prompts"),s=await e.json();s.success&&a(s.data)}catch(e){console.warn("Error loading templates:",e),j({message:"Error al cargar templates",type:"error"})}finally{y(!1)}},C=()=>{let a=e;n&&(a=a.filter(e=>e.category===n)),x&&(a=a.filter(e=>{var a;return e.name.toLowerCase().includes(x.toLowerCase())||(null==(a=e.description)?void 0:a.toLowerCase().includes(x.toLowerCase()))})),l(a)},E=e=>{w(e),v(!0)},A=e=>{let a=e.match(/\{([^}]+)\}/g);return a?a.map(e=>e.slice(1,-1)):[]};return h?(0,r.jsx)(m.Ay,{variant:"page"}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Gesti\xf3n de Prompts"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Crea y gestiona templates de prompts para diferentes tipos de contenido"})]}),(0,r.jsx)(o.$,{color:"primary",onClick:()=>{w(null),v(!0)},children:"Crear Prompt"})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)(c.p,{placeholder:"Buscar prompts...",value:x,onChange:e=>g(e.target.value),className:"flex-1"}),(0,r.jsxs)("select",{value:n,onChange:e=>d(e.target.value),className:"md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Todas las categor\xedas"}),p.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full border-collapse border border-gray-200",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50",children:[(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"NOMBRE"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"CATEGOR\xcdA"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"VARIABLES"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"P\xdaBLICO"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"ACCIONES"})]})}),(0,r.jsx)("tbody",{children:s.map(e=>{var a;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,r.jsx)("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:null==(a=p.find(a=>a.value===e.category))?void 0:a.label})}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:A(e.prompt).map((e,a)=>(0,r.jsx)("span",{className:"inline-block bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs border",children:e},a))})}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,r.jsx)("span",{className:"inline-block px-2 py-1 rounded text-sm ".concat(e.isPublic?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isPublic?"P\xfablico":"Privado"})}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:(0,r.jsx)(o.$,{onClick:()=>E(e),className:"text-sm",children:"Editar"})})]},e.id)})})]})}),0===s.length&&(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No se encontraron prompts"})})]})]}),(0,r.jsx)(u,{isOpen:f,onClose:()=>v(!1),template:N,onSave:S,onToast:j}),b&&(0,r.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:b.message})]})}function u(e){let{isOpen:a,onClose:s,template:l,onSave:n,onToast:i}=e,[m,x]=(0,t.useState)({name:"",description:"",category:"EMAIL",prompt:"",isPublic:!1}),[u,g]=(0,t.useState)(!1);(0,t.useEffect)(()=>{l?x({name:l.name,description:l.description||"",category:l.category,prompt:l.prompt,isPublic:l.isPublic}):x({name:"",description:"",category:"EMAIL",prompt:"",isPublic:!1})},[l]);let h=async()=>{if(!m.name||!m.prompt)return void i({message:"Nombre y prompt son requeridos",type:"error"});g(!0);try{let e=await fetch("/api/ai/prompts",{method:l?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...m,id:null==l?void 0:l.id})}),a=await e.json();a.success?(i({message:l?"Prompt actualizado":"Prompt creado exitosamente",type:"success"}),n(),s()):i({message:a.error||"Error al guardar prompt",type:"error"})}catch(e){console.warn("Error saving prompt:",e),i({message:"Error al guardar prompt",type:"error"})}finally{g(!1)}},y=(e=>{let a=e.match(/\{([^}]+)\}/g);return a?a.map(e=>e.slice(1,-1)):[]})(m.prompt);return(0,r.jsx)(d.A,{isOpen:a,onClose:s,title:l?"Editar Prompt":"Crear Nuevo Prompt",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:l?"Editar Prompt":"Crear Nuevo Prompt"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(c.p,{label:"Nombre",value:m.name,onChange:e=>x({...m,name:e.target.value}),placeholder:"Ej: Email de seguimiento comercial"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{value:m.description,onChange:e=>x({...m,description:e.target.value}),placeholder:"Describe el prop\xf3sito de este prompt",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda"}),(0,r.jsx)("select",{value:m.category,onChange:e=>x({...m,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:p.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prompt"}),(0,r.jsx)("textarea",{value:m.prompt,onChange:e=>x({...m,prompt:e.target.value}),placeholder:"Escribe tu prompt aqu\xed. Usa {variable} para variables din\xe1micas",rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),y.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Variables detectadas:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map((e,a)=>(0,r.jsx)("span",{className:"inline-block bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs border",children:e},a))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"isPublic",checked:m.isPublic,onChange:e=>x({...m,isPublic:e.target.checked})}),(0,r.jsx)("label",{htmlFor:"isPublic",className:"text-sm",children:"Hacer p\xfablico (otros usuarios podr\xe1n usar este prompt)"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,r.jsx)(o.$,{onClick:s,children:"Cancelar"}),(0,r.jsx)(o.$,{onClick:h,loading:u,className:"bg-blue-600 text-white",children:l?"Actualizar":"Crear"})]})]})})}var g=s(11201),h=s(63162),y=s(22708),b=s(64820),j=s(43194),f=s(83580),v=s(1567),N=s(11846),w=s(10497);let S=[{value:"EMAIL",label:"Email"},{value:"MESSAGE",label:"Mensaje"},{value:"PROPOSAL",label:"Propuesta"},{value:"FOLLOW_UP",label:"Seguimiento"},{value:"ANALYSIS",label:"An\xe1lisis"},{value:"SUMMARY",label:"Resumen"}];function C(){let[e,a]=(0,t.useState)([]),[s,i]=(0,t.useState)([]),[c,o]=(0,t.useState)(""),[d,p]=(0,t.useState)(""),[x,u]=(0,t.useState)("EMAIL"),[C,E]=(0,t.useState)(""),[A,k]=(0,t.useState)({}),[P,I]=(0,t.useState)(""),[L,O]=(0,t.useState)(!1),[T,D]=(0,t.useState)(!0),[z,R]=(0,t.useState)(null),[U,M]=(0,t.useState)("template");(0,t.useEffect)(()=>{G()},[]),(0,t.useEffect)(()=>{_()},[x]),(0,t.useEffect)(()=>{if(d){let e=s.find(e=>e.id===d);e&&F(e)}},[d,c]);let G=async()=>{D(!0);try{let e=await fetch("/api/prospects"),s=await e.json();s.success&&a(s.data),await _()}catch(e){console.warn("Error loading data:",e),R({message:"Error al cargar datos",type:"error"})}finally{D(!1)}},_=async()=>{try{let e=await fetch("/api/ai/prompts?category=".concat(x)),a=await e.json();a.success&&i(a.data)}catch(e){console.warn("Error loading templates:",e)}},F=a=>{let s=H(a.prompt),r={},t=e.find(e=>e.id===c);t?s.forEach(e=>{switch(e.toLowerCase()){case"firstname":case"nombre":r[e]=t.firstName||"";break;case"lastname":case"apellido":r[e]=t.lastName||"";break;case"fullname":case"nombrecompleto":r[e]=t.fullName||"".concat(t.firstName," ").concat(t.lastName);break;case"email":r[e]=t.email;break;case"company":case"empresa":r[e]=t.company||"";break;case"jobtitle":case"cargo":r[e]=t.jobTitle||"";break;case"industry":case"industria":r[e]=t.industry||"";break;default:r[e]=""}}):s.forEach(e=>{r[e]=""}),k(r)},H=e=>{let a=e.match(/\{([^}]+)\}/g);return a?a.map(e=>e.slice(1,-1)):[]},K=async()=>{let e="template"===U&&d,a="custom"===U?C:"";if(!e&&!a)return void R({message:"Selecciona un template o escribe un prompt personalizado",type:"error"});O(!0);try{let s=await fetch("/api/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:x,input:a||"Generar contenido usando el template seleccionado",leadId:c||void 0,promptTemplateId:e?d:void 0,customPrompt:a||void 0,variables:A})}),r=await s.json();r.success?(I(r.data.content),R({message:"Contenido generado exitosamente. Tokens: ".concat(r.data.tokensUsed,", Costo: $").concat(r.data.cost.toFixed(4)),type:"success"})):R({message:r.error||"Error al generar contenido",type:"error"})}catch(e){console.warn("Error generating content:",e),R({message:"Error al generar contenido",type:"error"})}finally{O(!1)}};if(T)return(0,r.jsx)(m.Ay,{variant:"page"});let q=s.find(e=>e.id===d),V=q?H(q.prompt):[];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(h.d,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Generador de Contenido IA"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Genera contenido personalizado usando IA para tus leads"})]})}),(0,r.jsxs)(y.U,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(b.d,{label:"Tipo de contenido",selectedKeys:[x],onSelectionChange:e=>{u(Array.from(e)[0]),p("")},children:S.map(e=>(0,r.jsx)(j.y,{children:e.label},e.value))}),(0,r.jsx)(b.d,{label:"Lead (opcional)",placeholder:"Selecciona un lead",selectedKeys:c?[c]:[],onSelectionChange:e=>{o(Array.from(e)[0]||"")},children:e.map(e=>(0,r.jsxs)(j.y,{children:[e.fullName," - ",e.company]},e.id))}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)(f.T,{color:"primary",onClick:K,isLoading:L,className:"w-full",children:"Generar Contenido"})})]}),(0,r.jsx)(v.y,{}),(0,r.jsxs)(l.r,{selectedKey:U,onSelectionChange:e=>M(e),children:[(0,r.jsx)(n.i,{title:"Usar Template",children:(0,r.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,r.jsx)(b.d,{label:"Template",placeholder:"Selecciona un template",selectedKeys:d?[d]:[],onSelectionChange:e=>{p(Array.from(e)[0]||"")},children:s.map(e=>(0,r.jsx)(j.y,{children:e.name},e.id))}),q&&(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Preview del Template:"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:q.prompt})]}),V.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Variables del Template:"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:V.map(e=>(0,r.jsx)(N.r,{label:e,value:A[e]||"",onChange:a=>k({...A,[e]:a.target.value}),placeholder:"Valor para {".concat(e,"}")},e))})]})]})},"template"),(0,r.jsx)(n.i,{title:"Prompt Personalizado",children:(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)(w.P,{label:"Prompt personalizado",value:C,onChange:e=>E(e.target.value),placeholder:"Escribe tu prompt personalizado aqu\xed...",rows:6,description:"Describe exactamente qu\xe9 tipo de contenido quieres generar"})})},"custom")]}),P&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.y,{}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Contenido Generado:"}),(0,r.jsx)(f.T,{size:"sm",variant:"bordered",onClick:()=>{navigator.clipboard.writeText(P),R({message:"Contenido copiado al portapapeles",type:"success"})},children:"Copiar"})]}),(0,r.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-gray-800",children:P})})]})]})]})]}),z&&(0,r.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:z.message})]})}var E=s(45998),A=s(46786);function k(){let[e,a]=(0,t.useState)([]),[s,l]=(0,t.useState)(null),[n,i]=(0,t.useState)(""),[c,o]=(0,t.useState)(!1),[d,p]=(0,t.useState)(!0),[x,u]=(0,t.useState)(null),b=(0,t.useRef)(null);(0,t.useEffect)(()=>{w()},[]),(0,t.useEffect)(()=>{j()},[null==s?void 0:s.messages]);let j=()=>{var e;null==(e=b.current)||e.scrollIntoView({behavior:"smooth"})},w=async()=>{p(!0);try{let e=await fetch("/api/ai/conversations"),s=await e.json();s.success&&(a(s.data),s.data.length>0&&l(s.data[0]))}catch(e){console.warn("Error loading conversations:",e),u({message:"Error al cargar conversaciones",type:"error"})}finally{p(!1)}},S=async()=>{let a="Nueva conversaci\xf3n ".concat(new Date().toLocaleDateString()),s="Asistente de ventas para an\xe1lisis de leads, estrategias comerciales y generaci\xf3n de contenido. Fecha: ".concat(new Date().toLocaleDateString());try{let r=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:a,context:s,message:"\xa1Hola! Soy tu asistente de ventas IA. \xbfEn qu\xe9 puedo ayudarte hoy?"})}),t=await r.json();if(t.success){await w();let a=e.find(e=>e.id===t.data.conversationId);a&&l(a)}else u({message:t.error||"Error al crear conversaci\xf3n",type:"error"})}catch(e){console.warn("Error creating conversation:",e),u({message:"Error al crear conversaci\xf3n",type:"error"})}},C=async()=>{if(!n.trim())return;if(!s)return void await S();i(""),o(!0);let e={id:"temp-user",role:"USER",content:n,createdAt:new Date().toISOString()};l(a=>a?{...a,messages:[...a.messages,e]}:null);try{let e=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversationId:s.id,message:n})}),a=await e.json();a.success?await k(s.id):(u({message:a.error||"Error al enviar mensaje",type:"error"}),l(e=>e?{...e,messages:e.messages.filter(e=>"temp-user"!==e.id)}:null))}catch(e){console.warn("Error sending message:",e),u({message:"Error al enviar mensaje",type:"error"}),l(e=>e?{...e,messages:e.messages.filter(e=>"temp-user"!==e.id)}:null)}finally{o(!1)}},k=async e=>{try{let a=await fetch("/api/ai/conversations/".concat(e)),s=await a.json();s.success&&l(s.data)}catch(e){console.warn("Error loading conversation messages:",e)}},P=e=>new Date(e).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),I=["Analiza los leads m\xe1s prometedores","Crea un email de seguimiento","Estrategia para cerrar m\xe1s ventas","An\xe1lisis de objeciones comunes","Propuesta de valor para cliente","Mejores pr\xe1cticas de prospecci\xf3n"];return d?(0,r.jsx)(m.Ay,{variant:"page"}):(0,r.jsxs)("div",{className:"flex h-[600px] space-x-4",children:[(0,r.jsx)("div",{className:"w-1/4 min-w-[250px]",children:(0,r.jsxs)(g.Z,{className:"h-full",children:[(0,r.jsx)(h.d,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"Conversaciones"}),(0,r.jsx)(f.T,{size:"sm",color:"primary",onClick:S,children:"Nueva"})]})}),(0,r.jsx)(y.U,{className:"p-0",children:(0,r.jsx)("div",{className:"space-y-1",children:e.map(e=>(0,r.jsxs)("div",{className:"p-3 cursor-pointer hover:bg-gray-50 border-l-3 ".concat((null==s?void 0:s.id)===e.id?"bg-blue-50 border-l-blue-500":"border-l-transparent"),onClick:()=>l(e),children:[(0,r.jsx)("p",{className:"font-medium text-sm truncate",children:e.title}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.updatedAt).toLocaleDateString()}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:[e.messages.length," mensajes"]})]},e.id))})})]})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)(g.Z,{className:"h-full flex flex-col",children:[(0,r.jsx)(h.d,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(E.Q,{src:"/ai-avatar.png",name:"AI",size:"sm",className:"bg-gradient-to-r from-blue-500 to-purple-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold",children:(null==s?void 0:s.title)||"Asistente IA"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Asistente de ventas especializado"})]})]})}),(0,r.jsx)(v.y,{}),(0,r.jsxs)(y.U,{className:"flex-1 flex flex-col p-0",children:[(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s?(0,r.jsxs)(r.Fragment,{children:[s.messages.map(e=>(0,r.jsx)("div",{className:"flex ".concat("USER"===e.role?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-[80%] p-3 rounded-lg ".concat("USER"===e.role?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"),children:[(0,r.jsx)("p",{className:"whitespace-pre-wrap",children:e.content}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2 text-xs opacity-70",children:[(0,r.jsx)("span",{children:P(e.createdAt)}),e.tokensUsed&&(0,r.jsxs)("span",{children:[e.tokensUsed," tokens"]})]})]})},e.id)),c&&(0,r.jsx)("div",{className:"flex justify-start",children:(0,r.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg",children:(0,r.jsx)(m.Ay,{variant:"inline"})})})]}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)(E.Q,{size:"lg",className:"bg-gradient-to-r from-blue-500 to-purple-500 mx-auto mb-3"}),(0,r.jsx)("h4",{className:"font-semibold text-lg",children:"\xa1Hola! Soy tu asistente IA"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Estoy aqu\xed para ayudarte con an\xe1lisis de leads, estrategias de ventas y generaci\xf3n de contenido."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Prueba estas consultas:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:I.map((e,a)=>(0,r.jsx)(A.R,{variant:"bordered",className:"cursor-pointer hover:bg-blue-50",onClick:()=>i(e),children:e},a))})]})]}),(0,r.jsx)("div",{ref:b})]}),(0,r.jsx)(v.y,{}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(N.r,{value:n,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C())},placeholder:"Escribe tu mensaje...",className:"flex-1",disabled:c}),(0,r.jsx)(f.T,{color:"primary",onClick:C,isLoading:c,disabled:!n.trim(),children:"Enviar"})]}),!s&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:I.slice(0,3).map((e,a)=>(0,r.jsx)(A.R,{size:"sm",variant:"bordered",className:"cursor-pointer hover:bg-blue-50",onClick:()=>i(e),children:e},a))})})]})]})]})})]})}function P(){let[e,a]=(0,t.useState)("assistant"),[s,i]=(0,t.useState)(!0);(0,t.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await fetch("/api/ai/config");await e.json()}catch(e){console.warn("Error checking OpenAI config:",e)}finally{i(!1)}};return s?(0,r.jsx)(m.Ay,{variant:"page",message:"Verificando configuraci\xf3n de IA..."}):(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Centro de IA"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Potencia tu prospecci\xf3n con inteligencia artificial"})]}),(0,r.jsxs)(l.r,{selectedKey:e,onSelectionChange:e=>a(e),className:"w-full",size:"lg",children:[(0,r.jsx)(n.i,{title:"\uD83E\uDD16 Asistente IA",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(k,{})})},"assistant"),(0,r.jsx)(n.i,{title:"âœ¨ Generador de Contenido",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(C,{})})},"generator"),(0,r.jsx)(n.i,{title:"\uD83D\uDCDD Gesti\xf3n de Prompts",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(x,{})})},"prompts")]})]})}},93915:(e,a,s)=>{"use strict";s.d(a,{p:()=>t});var r=s(95155);let t=(0,s(12115).forwardRef)((e,a)=>{let{label:s,error:t,helpText:l,variant:n="default",size:i="md",leftIcon:c,rightIcon:o,icon:d,fullWidth:m=!1,className:p="",...x}=e,u=t?"border-red-300 focus:border-red-500 focus:ring-red-500":"",g=x.disabled?"opacity-50 cursor-not-allowed bg-gray-100":"",h=c||d,y="\n    ".concat("block border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","\n    ").concat({default:"border-gray-300 focus:border-blue-500",filled:"border-gray-300 bg-gray-50 focus:bg-white focus:border-blue-500",outlined:"border-2 border-gray-300 focus:border-blue-500"}[n],"\n    ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[i],"\n    ").concat(u,"\n    ").concat(g,"\n    ").concat(m?"w-full":"","\n    ").concat(h?"pl-10":"","\n    ").concat(o?"pr-10":"","\n    ").concat(p,"\n  ").trim();return(0,r.jsxs)("div",{className:m?"w-full":"",children:[s&&(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s}),(0,r.jsxs)("div",{className:"relative",children:[h&&(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("span",{className:"text-gray-500 sm:text-sm",children:h})}),(0,r.jsx)("input",{ref:a,className:y,...x}),o&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,r.jsx)("span",{className:"text-gray-500 sm:text-sm",children:o})})]}),t&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:t}),l&&!t&&(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l})]})});t.displayName="Input"}},e=>{var a=a=>e(e.s=a);e.O(0,[545,71,907,156,134,944,968,441,684,358],()=>a(60681)),_N_E=e.O()}]);